<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="ë¶€ì‚°í•­ í˜„ì¥ì§ í•„ìˆ˜ ì•±. ì„ê¸ˆê³„ì‚°ê¸°, ìŠ¤ë§ˆíŠ¸ ê·¼ë¬´ì¼ì§€(ì§ì§€ê¸°ë¡), ì„ ë°•ìœ„ì¹˜ ë° ìŠ¤ì¼€ì¤„ ì¡°íšŒ.">
    <meta name="keywords" content="ë¶€ì‚°í•­, í˜„ì¥ì§, ì„ê¸ˆê³„ì‚°, ê·¼ë¬´ì¼ì§€, ì„ ë°•ìŠ¤ì¼€ì¤„, ê°±, YT, QC, Lashing">
    <title>BUSAN HAK PORT INFO</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6024353303588422" crossorigin="anonymous"></script>

    <link rel="icon" type="image/png" sizes="32x32" href="icon.png?v=fixed_final_v12">
    <link rel="stylesheet" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />

    <style>
        :root { --primary: #1e3a8a; --primary-light: #3b82f6; --accent: #f59e0b; --bg-color: #f3f4f6; --card-bg: rgba(255, 255, 255, 0.95); --text-main: #1f2937; --text-sub: #6b7280; --border: rgba(229, 231, 235, 0.8); --danger: #ef4444; --success: #10b981; --glass-border: 1px solid rgba(255, 255, 255, 0.6); --glass-shadow: 0 2px 10px rgba(0,0,0,0.03); --blur: blur(12px); }
        body.dark-mode { --primary: #60a5fa; --primary-light: #93c5fd; --accent: #fbbf24; --bg-color: #0f172a; --card-bg: rgba(30, 41, 59, 0.95); --text-main: #f3f4f6; --text-sub: #9ca3af; --border: rgba(55, 65, 81, 0.5); --glass-border: 1px solid rgba(255, 255, 255, 0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Pretendard', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); margin: 0; padding: 0; padding-bottom: 100px; transition: background 0.3s ease; }
        .tap-effect { transition: transform 0.1s; } .tap-effect:active { transform: scale(0.98); }
        header { background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white; padding: 14px 0; text-align: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        header h1 { margin: 0; font-size: 1.2rem; font-weight: 900; }
        .theme-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; width: 30px; height: 30px; border-radius: 50%; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .container { width: 96%; max-width: 600px; margin: 15px auto; }
        .dash-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .dash-card { background: var(--card-bg); border-radius: 16px; box-shadow: var(--glass-shadow); border: var(--glass-border); overflow: hidden; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); display: flex; flex-direction: column; }
        .dash-card.expanded { grid-column: span 2; }
        .dash-header { padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.05); min-height: 60px; }
        .dash-title { font-size: 1rem; font-weight: 800; color: var(--text-main); display: flex; align-items: center; gap: 6px; }
        .toggle-icon { font-size: 0.8rem; color: var(--text-sub); transition: transform 0.3s; }
        .toggle-icon.rotated { transform: rotate(180deg); }
        .dash-content { display: none; padding: 15px; background: var(--card-bg); animation: fadeIn 0.2s; }
        .card { background: var(--card-bg); border-radius: 16px; margin-bottom: 15px; box-shadow: var(--glass-shadow); border: var(--glass-border); overflow: hidden; }
        .section-header { display: flex; justify-content: space-between; align-items: center; padding: 15px; cursor: pointer; border-bottom: 1px solid var(--border); }
        .section-title { font-size: 1.1rem; font-weight: 800; display:flex; align-items:center; gap:8px; }
        .collapsible-content { display: block; padding: 15px; }
        .collapsible-content.collapsed { display: none !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        .input-field { width: 100%; padding: 12px; margin-bottom: 8px; border: 1px solid var(--border); border-radius: 8px; background: rgba(255,255,255,0.6); color: var(--text-main); font-size: 0.95rem; }
        .textarea-field { height: 80px; resize: none; }
        .action-btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-weight: 700; color: white; cursor: pointer; background: var(--primary); font-size: 0.95rem; }
        .bg-submit { background: var(--success); } .bg-calc { background: linear-gradient(135deg, #ef4444, #b91c1c); } .bg-cancel { background: var(--text-sub); }
        .wage-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .wage-row label { flex: 1; font-weight: 600; font-size: 0.9rem; }
        .wage-result-box { background: linear-gradient(135deg, #fff7ed, #ffedd5); border: 2px solid var(--accent); border-radius: 12px; padding: 15px; text-align: center; margin-top: 15px; }
        .wage-total { font-size: 1.6rem; color: #c2410c; font-weight: 900; }
        .ticker-container { background: var(--accent); color: #000; font-weight: 700; height: 36px; display: flex; align-items: center; overflow: hidden; position: relative; font-size: 0.85rem; }
        .ticker-item { padding-left: 100%; animation: ticker 25s linear infinite; white-space: nowrap; }
        @keyframes ticker { 100% { transform: translate3d(-100%, 0, 0); } }
        .ticker-controls { position: absolute; right: 0; height: 100%; display: flex; background: rgba(255,255,255,0.3); backdrop-filter: blur(2px); }
        .ticker-btn { width: 36px; height: 100%; border: none; background: transparent; font-size: 1rem; cursor: pointer; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 65px; background: rgba(255,255,255,0.95); border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { flex: 1; text-align: center; color: var(--text-sub); font-size: 0.7rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        .nav-item.active { color: var(--primary); font-weight: 800; }
        .comment-section { margin-top: 15px; border-top: 1px dashed var(--border); padding: 10px; background: rgba(0,0,0,0.015); border-radius: 8px; }
        .comment-item { display: flex; justify-content: space-between; font-size: 0.85rem; padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .comment-meta { font-weight: bold; color: var(--primary); margin-right: 5px; }
        .comment-del-btn { background: none; border: none; color: var(--text-sub); cursor: pointer; font-size: 0.7rem; }
        .page-num { padding: 5px 10px; border: 1px solid var(--border); cursor: pointer; border-radius: 5px; font-size: 0.8rem; margin: 0 2px; }
        .page-num.active { background: var(--primary); color: white; }
        #toast { position: fixed; bottom: 85px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.85); color: white; padding: 10px 20px; border-radius: 20px; font-size: 0.9rem; z-index: 5000; opacity: 0; transition: 0.3s; pointer-events: none; }
        #toast.show { opacity: 1; }
        .hidden { display: none !important; }
        .post-list { list-style: none; padding: 0; margin: 0; }
        .post-item { border-bottom: 1px solid var(--border); }
        .post-header-row { padding: 15px 5px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .post-title-text { font-weight: 700; font-size: 0.95rem; color: var(--text-main); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .post-body-content { display: none; padding: 15px; background: rgba(0,0,0,0.02); border-top: 1px dashed var(--border); font-size: 0.95rem; white-space: pre-wrap; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; text-align: center; }
        .cal-day { padding: 8px 2px; border-radius: 8px; background: rgba(255,255,255,0.5); border: 1px solid var(--border); font-weight: 700; font-size: 0.85rem; }
        .cal-day.selected { background: var(--primary); color: white; }
        .cal-dot { width: 4px; height: 4px; background-color: var(--success); border-radius: 50%; margin: 3px auto 0 auto; display: none; }
        .cal-day.has-data .cal-dot { display: block; }
    </style>
</head>
<body>

    <header>
        <h1>BUSAN HAK PORT</h1>
        <button class="theme-toggle tap-effect" onclick="toggleDarkMode()">ğŸŒ™</button>
    </header>

    <div id="safetyTicker" class="ticker-container">
        <div class="ticker-wrap"><div id="tickerText" class="ticker-item">ğŸš¨ ì•ˆì „ ì œì¼! ì˜¤ëŠ˜ë„ ë¬´ì‚¬ê³ !</div></div>
        <div class="ticker-controls">
            <button class="ticker-btn tap-effect" onclick="writeUserTicker()">ğŸ—£ï¸</button>
            <button class="ticker-btn tap-effect" onclick="setAdminTicker()">ğŸ“¢</button>
            <button class="ticker-btn tap-effect" onclick="resetTicker()">âš™ï¸</button>
        </div>
    </div>

    <div class="container">
        
        <div class="dash-grid">
            <div id="wage-card" class="dash-card" style="border:1px solid var(--danger);">
                <div class="dash-header tap-effect" onclick="toggleDashItem('wage-card')">
                    <span class="dash-title" style="color:var(--danger);">ğŸ’° ì§€ëŠ¥í˜• ì„ê¸ˆ ê³„ì‚°ê¸°</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <div class="wage-row"><label>ì‹œê¸‰(ê¸°ë³¸)</label><input type="number" id="wageHourly" class="input-field" value="10320" style="text-align:right;" readonly>ì›</div>
                    
                    <div style="background:rgba(239,68,68,0.05); padding:12px; border-radius:10px; margin-bottom:12px; border:1px solid rgba(239,68,68,0.2);">
                        <div class="wage-row"><label>â³ ì´ ê·¼ë¬´ì‹œê°„</label><input type="number" id="wageTotalHours" class="input-field" placeholder="ì˜ˆ: 24, 48" style="text-align:right; border:2px solid var(--danger);">H</div>
                        <div class="wage-row"><label>ğŸ•’ ì‹œì‘ ì‹œê°</label><input type="number" id="wageStartTime" class="input-field" value="8" placeholder="0~23" style="text-align:right;">ì‹œ</div>
                    </div>
                    
                    <div style="border-top:1px dashed var(--border); margin:10px 0; padding-top:10px;">
                        <p style="font-size:0.75rem; color:var(--primary); font-weight:800; margin-bottom:8px;">âœ… ìˆ˜ë‹¹ ë°œìƒ ì‹œê°„ ì…ë ¥ (ì¤‘ë³µ ê°€ëŠ¥)</p>
                        <div class="wage-row"><label>ğŸŒ‘ ì‹¬ì•¼í• ì¦ (00~04ì‹œ)</label><input type="number" id="wageDeepNight" class="input-field" placeholder="H" style="text-align:right;">H</div>
                        <div class="wage-row"><label>â˜” ìš°ì²œ/ê³µíœ´ì¼/ì£¼ë§</label><input type="number" id="wageSpecial" class="input-field" placeholder="H" style="text-align:right;">H</div>
                        <div class="wage-row"><label>ğŸ”¥ í˜¹ì„œê¸° (12~15ì‹œ)</label><input type="number" id="wageHotTime" class="input-field" placeholder="H" style="text-align:right;">H</div>
                    </div>

                    <select id="wageWorkType" class="input-field">
                        <option value="1">ì¼ë°˜ ì‘ì—… (ê¸°ë³¸)</option>
                        <option value="1.1">ë‚œì‘ì—… í• ì¦ (10%)</option>
                        <option value="1.2">CAR CARRIER (20%)</option>
                    </select>

                    <div style="display:flex; gap:8px; margin-top:10px;">
                        <button class="action-btn bg-calc" style="flex:2" onclick="calculateWage()">ì§€ëŠ¥í˜• ê³„ì‚°</button>
                        <button class="action-btn bg-cancel" style="flex:1" onclick="resetWageForm()">ì´ˆê¸°í™”</button>
                    </div>

                    <div id="wageResultBox" class="hidden wage-result-box">
                        <div id="wageCalculationDetail" style="font-size:0.75rem; color:var(--text-sub); margin-bottom:5px;"></div>
                        <div id="wageTotal" class="wage-total">0ì›</div>
                    </div>
                </div>
            </div>

            <div id="log-card" class="dash-card" style="border:1px solid var(--primary);">
                <div class="dash-header tap-effect" onclick="checkAdminAndOpenLog('log-card')">
                    <span class="dash-title" style="color:var(--primary);">ğŸ“… ìŠ¤ë§ˆíŠ¸ ê·¼ë¬´ì¼ì§€</span><span class="toggle-icon">â–¼</span>
                </div>
                <div id="workLogArea" class="dash-content">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;"><button class="mini-btn" onclick="changeMonth(-1)">â—€</button><span id="calMonthYear" style="font-weight:bold;"></span><button class="mini-btn" onclick="changeMonth(1)">â–¶</button></div>
                    <div id="calendarGrid" class="calendar-grid"></div>
                    <div id="dailyLogForm" class="hidden" style="margin-top:15px; padding:15px; background:rgba(0,0,0,0.03); border-radius:12px;">
                        <h4 id="selectedDateText" style="margin:0 0 10px 0; color:var(--primary);"></h4>
                        <div class="wage-row"><label>ì£¼ê°„</label><input type="number" id="logDayHours" class="input-field" placeholder="H"></div>
                        <div class="wage-row"><label>ì•¼ê°„</label><input type="number" id="logNightHours" class="input-field" placeholder="H"></div>
                        <textarea id="logMemo" class="input-field textarea-field" placeholder="ë©”ëª¨..."></textarea>
                        <button class="action-btn bg-submit" onclick="saveWorkLog()">ì €ì¥</button>
                        <button class="action-btn bg-cancel" style="background:var(--danger); margin-top:5px;" onclick="deleteWorkLog()">ì‚­ì œ</button>
                    </div>
                    <div id="monthlyTotalDisplay" style="text-align:center; margin-top:15px; font-weight:bold; color:var(--primary);">0ì›</div>
                </div>
            </div>
        </div>

        <div class="card" style="border-left: 5px solid #3b82f6;">
            <div class="section-header tap-effect" onclick="toggleSection('t3-content', this)"><span class="section-title">â›´ï¸ 3í•­ì—… (ì‹ í•­ ë‚¨ì¸¡) â–¼</span></div>
            <div id="t3-content" class="collapsible-content collapsed">
                <div class="terminal-block">
                    <div class="wage-row"><a href="https://www.hjnc.co.kr" target="_blank" class="action-btn" style="text-align:center; text-decoration:none;">í•œì§„ì‹ í•­ë§Œ (HJNC) ì¡°íšŒ</a></div>
                    <div class="wage-row"><a href="https://info.bnctkorea.com" target="_blank" class="action-btn" style="text-align:center; text-decoration:none;">BNCT ì •ë³´ ì¡°íšŒ</a></div>
                </div>
            </div>
        </div>
        
        <div class="card" style="border-left: 5px solid #10b981;">
            <div class="section-header tap-effect" onclick="toggleSection('t2-content', this)"><span class="section-title">ğŸ—ï¸ 2í•­ì—… (ì‹ í•­ ë¶ì¸¡) â–¼</span></div>
            <div id="t2-content" class="collapsible-content collapsed">
                <div class="terminal-block">
                    <a href="https://svc.pncport.com" target="_blank" class="action-btn" style="text-align:center; text-decoration:none;">ë¶€ì‚°ì‹ í•­ë§Œ (PNC) ì¡°íšŒ</a>
                </div>
            </div>
        </div>

        <div class="card" style="border-left: 5px solid #f97316;">
            <div class="section-header tap-effect" onclick="toggleSection('t1-content', this)"><span class="section-title">âš“ 1í•­ì—… (ë¶í•­) â–¼</span></div>
            <div id="t1-content" class="collapsible-content collapsed">
                <div class="terminal-block">
                    <a href="http://info.bptc.co.kr:9084" target="_blank" class="action-btn" style="text-align:center; text-decoration:none;">ë¶í•­ í†µí•© (BPTC) ì„ ì„ ì¡°íšŒ</a>
                </div>
            </div>
        </div>

        <div class="card" style="padding:15px; font-size:0.85rem; line-height:1.7; border-left: 5px solid var(--primary);">
            <h4 style="margin:0 0 10px 0; color:var(--primary);">ğŸ“˜ ë¶€ì‚°í•­ í˜„ì¥ ê·¼ë¬´ ë° ë³´ì•ˆ ê°€ì´ë“œ</h4>
            <p>2026ë…„ 3í•­ì—…ì§€ë¶€ ì„ê¸ˆí‘œ ê¸°ì¤€, ì£¼ê°„(08~18ì‹œ) ì‹œê¸‰ì€ 10,320ì›ì´ë©° ì•¼ê°„(18~08ì‹œ)ì€ 15,480ì›ì´ ì ìš©ë©ë‹ˆë‹¤. ë¶€ì‚°í•­ ëª¨ë“  í„°ë¯¸ë„ì€ êµ­ê°€ ë³´ì•ˆ ì‹œì„¤ë¡œ ì¶œì… ì‹œ ì‚¬ì „ ë“±ë¡ì´ í•„ìˆ˜ì´ë©°, ì•ˆì „ëª¨ ë° ì•ˆì „ì¡°ë¼ ì°©ìš©ì€ ì˜ë¬´ì…ë‹ˆë‹¤.</p>
        </div>

        <div class="dash-grid">
            <div id="notice-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('notice-card')">ğŸ“¢ ê³µì§€ì‚¬í•­ â–¼</div>
                <div class="dash-content">
                    <input type="text" id="noticeTitle" class="input-field" placeholder="ì œëª©">
                    <textarea id="noticeContent" class="input-field textarea-field" placeholder="ë‚´ìš©"></textarea>
                    <button class="action-btn bg-submit" onclick="addNotice()">ê³µì§€ ë“±ë¡ (Admin)</button>
                    <ul id="noticeList" class="post-list" style="margin-top:10px;"></ul>
                </div>
            </div>

            <div id="board-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('board-card')">ğŸ’¬ ìµëª…ê²Œì‹œíŒ â–¼</div>
                <div class="dash-content">
                    <button class="action-btn" style="background:var(--text-sub); margin-bottom:10px;" onclick="toggleHidden('boardForm')">âœï¸ ê¸€ì“°ê¸°</button>
                    <div id="boardForm" class="hidden">
                        <input type="text" id="inputTitle" class="input-field" placeholder="ì œëª©">
                        <input type="password" id="inputPw" class="input-field" placeholder="ë¹„ë²ˆ">
                        <textarea id="inputContent" class="input-field textarea-field" placeholder="ë‚´ìš©"></textarea>
                        <button class="action-btn bg-submit" onclick="addPost()">ë“±ë¡</button>
                    </div>
                    <ul id="boardList" class="post-list"></ul>
                    <div id="pagination" style="display:flex; justify-content:center; margin-top:10px;"></div>
                </div>
            </div>
            
            <div id="ship-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('ship-card')">ğŸš¢ ì„ ë°•ì •ë³´ â–¼</div>
                <div class="dash-content">
                    <input type="text" id="shipSearch" class="input-field" placeholder="ê²€ìƒ‰..." onkeyup="filterShips()">
                    <button class="action-btn" style="background:var(--accent);" onclick="toggleHidden('shipForm')">ğŸ“ ì„ ë°• ì •ë³´ ë“±ë¡</button>
                    <div id="shipForm" class="hidden">
                        <input type="text" id="shipName" class="input-field" placeholder="ì„ ë°•ëª…">
                        <textarea id="shipOnboard" class="input-field textarea-field" placeholder="ë³¸ì„  ì‘ì—…"></textarea>
                        <input type="file" id="shipFileInput" class="input-field">
                        <button id="shipSubmitBtn" class="action-btn bg-submit" onclick="addShipInfo()">ë“±ë¡/ìˆ˜ì •</button>
                    </div>
                    <ul id="shipList" class="post-list"></ul>
                </div>
            </div>

            <div id="file-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('file-card')">ğŸ“‚ ìë£Œì‹¤ â–¼</div>
                <div class="dash-content">
                    <input type="file" id="fileInput" class="input-field">
                    <input type="text" id="fileTitle" class="input-field" placeholder="íŒŒì¼ ì œëª©">
                    <button class="action-btn bg-submit" onclick="uploadFile()">ì—…ë¡œë“œ</button>
                    <ul id="fileList" class="post-list" style="margin-top:10px;"></ul>
                </div>
            </div>
        </div>

        <footer>
            <p>Â© 2026 BUSAN HAK PORT INFO. All rights reserved.</p>
            <div style="margin-top:10px;"><span class="footer-link" onclick="openPrivacy()">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span></div>
        </footer>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="location.reload()">ğŸ  í™ˆ</div>
        <div class="nav-item" onclick="toggleDashItem('board-card')">ğŸ’¬ í†¡í†¡</div>
        <div class="nav-item" onclick="toggleDashItem('ship-card')">ğŸš¢ ì„ ë°•</div>
        <div class="nav-item" onclick="toggleDashItem('file-card')">ğŸ“‚ ìë£Œ</div>
    </nav>

    <div id="toast"></div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyBDXy5HcYW-IZQJ9ZDEivr_yi99AxhYme8", authDomain: "my-app-d8527.firebaseapp.com", projectId: "my-app-d8527", storageBucket: "my-app-d8527.firebasestorage.app", messagingSenderId: "667323279185", appId: "1:667323279185:web:cff6184aaa82e08d345570" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(), storage = firebase.storage();
        let allPostsData=[], allShipsData=[], filteredShips=[], adminWorkLogs={}, editingShipId=null;
        let currentBoardPage=1; const postsPerPage=5; let commentUnsubscribes = {};

        function showToast(m){const t=document.getElementById("toast"); t.innerText=m; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),3000);}
        function toggleDashItem(id){const c=document.getElementById(id); const e=c.classList.contains('expanded'); document.querySelectorAll('.dash-card').forEach(x=>{x.classList.remove('expanded'); x.querySelector('.dash-content').style.display='none';}); if(!e){c.classList.add('expanded'); c.querySelector('.dash-content').style.display='block';}}
        function toggleSection(id,el){document.getElementById(id).classList.toggle('collapsed');}
        function toggleContent(id){const e=document.getElementById(id); e.style.display=(e.style.display==='block'?'none':'block');}
        function toggleHidden(id){document.getElementById(id).classList.toggle('hidden');}
        function toggleDarkMode(){document.body.classList.toggle('dark-mode');}

        // [ì´ë¯¸ì§€ ê¸°ë°˜ ì„ê¸ˆ ë¡œì§]
        function calculateWage() {
            const DAY_RATE = 10320, NIGHT_RATE = 15480, EXTRA_ADD = 5160, HOT_ADD = 3096;
            const totalHours = parseFloat(document.getElementById('wageTotalHours').value) || 0;
            const startHour = parseInt(document.getElementById('wageStartTime').value) || 8;
            const dN = parseFloat(document.getElementById('wageDeepNight').value) || 0;
            const sp = parseFloat(document.getElementById('wageSpecial').value) || 0;
            const hT = parseFloat(document.getElementById('wageHotTime').value) || 0;
            const wF = parseFloat(document.getElementById('wageWorkType').value) || 1;

            let dayCount = 0, nightCount = 0;
            for (let i = 0; i < totalHours; i++) {
                let current = (startHour + i) % 24;
                if (current >= 8 && current < 18) dayCount++; else nightCount++;
            }

            let total = (dayCount * DAY_RATE) + (nightCount * NIGHT_RATE);
            total += (dN * EXTRA_ADD) + (sp * EXTRA_ADD) + (hT * HOT_ADD);
            total *= wF;

            document.getElementById('wageCalculationDetail').innerText = `ë°°ë¶„ ê²°ê³¼: ì£¼ê°„ ${dayCount}H / ì•¼ê°„ ${nightCount}H`;
            document.getElementById('wageTotal').innerText = Math.floor(total).toLocaleString() + "ì›";
            document.getElementById('wageResultBox').classList.remove('hidden');
        }

        function resetWageForm(){document.querySelectorAll('#wage-card input').forEach(i=>i.value=''); document.getElementById('wageStartTime').value=8;}

        // [ê²Œì‹œíŒ ë° ì‹¤ì‹œê°„ ì—°ë™]
        function loadAllData(){
            db.collection("notices").orderBy("timestamp","desc").onSnapshot(s=>{const l=document.getElementById("noticeList"); l.innerHTML=""; s.forEach(d=>{const x=d.data(); l.innerHTML+=`<li class="post-item" onclick="toggleContent('n-${d.id}')">ğŸ“¢ <strong>${x.title}</strong><div id="n-${d.id}" class="post-body-content">${x.content}</div></li>`;})});
            db.collection("posts").orderBy("timestamp","desc").onSnapshot(s=>{allPostsData=[]; s.forEach(d=>{allPostsData.push({...d.data(), id:d.id})}); renderBoardPage(1);});
            db.collection("ships").orderBy("timestamp","desc").onSnapshot(s=>{allShipsData=[]; s.forEach(d=>{allShipsData.push({...d.data(), id:d.id})}); renderShipPage(1);});
            loadBanner();
        }

        function renderBoardPage(p){
            currentBoardPage=p; const l=document.getElementById("boardList"); l.innerHTML="";
            allPostsData.slice((p-1)*postsPerPage, p*postsPerPage).forEach(x=>{
                l.innerHTML+=`<li class="post-item"><div class="post-header-row" onclick="toggleContent('p-${x.id}')"><span>${x.title}</span><button class="mini-btn btn-del" onclick="deletePost('${x.id}','${x.password}',event)">ì‚­ì œ</button></div><div id="p-${x.id}" class="post-body-content">${x.content}<div id="cmt-list-${x.id}" class="comment-section"></div></div></li>`;
                loadComments(x.id);
            });
            renderPagination();
        }

        function loadComments(pid){
            db.collection('posts').doc(pid).collection('comments').orderBy('timestamp','asc').onSnapshot(s=>{
                const el=document.getElementById(`cmt-list-${pid}`); if(!el) return; el.innerHTML="";
                s.forEach(d=>{const c=d.data(); el.innerHTML+=`<div class="comment-item"><span><b>${c.name}:</b> ${c.text}</span></div>`;});
            });
        }

        // [ê´€ë¦¬ ê¸°ëŠ¥]
        async function verifyAdmin(){const i=prompt("Admin PW:"); return i==="0346";}
        async function addNotice(){if(await verifyAdmin()){db.collection("notices").add({title:document.getElementById('noticeTitle').value, content:document.getElementById('noticeContent').value, timestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(()=>showToast("ë“±ë¡ ì™„ë£Œ"));}}
        function addPost(){db.collection("posts").add({title:document.getElementById('inputTitle').value, password:document.getElementById('inputPw').value, content:document.getElementById('inputContent').value, timestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(()=>{showToast("ì™„ë£Œ"); toggleHidden('boardForm');});}
        async function deletePost(id, pw, e){e.stopPropagation(); const ip=prompt("ë¹„ë²ˆ:"); if(ip===pw || await verifyAdmin()){db.collection("posts").doc(id).delete().then(()=>showToast("ì‚­ì œë¨"));}}

        function loadBanner(){
            db.collection('settings').doc('banner').onSnapshot(doc => {
                if (doc.exists) {
                    const d=doc.data(); let msg="";
                    if(d.adminMessage) msg+=`ğŸš¨ ${d.adminMessage} / `;
                    if(d.messages) msg+=d.messages.join(" / ");
                    document.getElementById('tickerText').innerText = msg || "ğŸš¨ ì•ˆì „ ì œì¼!";
                }
            });
        }

        window.onload=loadAllData;
    </script>
</body>
</html>
