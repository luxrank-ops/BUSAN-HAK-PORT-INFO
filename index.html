<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>BUSAN HAK PORT INFO</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<!-- Font -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">

<style>
:root{
  --primary:#1e3a8a;
  --accent:#f59e0b;
  --bg:#f3f4f6;
  --card:#ffffff;
  --border:#e5e7eb;
  --danger:#ef4444;
  --success:#10b981;
}
body{
  margin:0;
  font-family:'Pretendard',sans-serif;
  background:var(--bg);
}
header{
  position:sticky;
  top:0;
  background:linear-gradient(135deg,#1e3a8a,#3b82f6);
  color:#fff;
  padding:14px;
  text-align:center;
  font-weight:900;
}
.container{
  width:96%;
  max-width:600px;
  margin:15px auto;
}
.dash-card{
  background:var(--card);
  border-radius:16px;
  border:1px solid var(--border);
  margin-bottom:12px;
  overflow:hidden;
}
.dash-header{
  padding:15px;
  display:flex;
  justify-content:space-between;
  cursor:pointer;
  font-weight:800;
}
.dash-content{
  display:none;
  padding:15px;
}
.dash-card.expanded .dash-content{
  display:block;
}
.input-field{
  width:100%;
  padding:10px;
  margin-bottom:6px;
}
.textarea-field{
  height:80px;
}
.action-btn{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-weight:800;
  cursor:pointer;
}
.bg-submit{background:var(--success);color:#fff;}
.bg-danger{background:var(--danger);color:#fff;}

.post-list{list-style:none;padding:0;margin:0;}
.post-item{border-bottom:1px solid var(--border);}
.post-body{display:none;padding:10px;background:#f9fafb;}

.port3{border-left:6px solid #1e3a8a;}
.port2{border-left:6px solid #065f46;}
.port1{border-left:6px solid #f59e0b;}
</style>
</head>

<body>
<header>BUSAN HAK PORT</header>

<div class="container">

<!-- ê³µì§€ì‚¬í•­ -->
<div id="notice-card" class="dash-card">
  <div class="dash-header" onclick="toggleCard(this)">ğŸ“¢ ê³µì§€ì‚¬í•­</div>
  <div class="dash-content">
    <input id="noticeTitle" class="input-field" placeholder="ì œëª©">
    <textarea id="noticeContent" class="input-field textarea-field" placeholder="ë‚´ìš©"></textarea>
    <button class="action-btn bg-submit" onclick="addNotice()">ê³µì§€ ë“±ë¡</button>
    <ul id="noticeList" class="post-list"></ul>
  </div>
</div>

<!-- ìµëª…ê²Œì‹œíŒ -->
<div id="board-card" class="dash-card">
  <div class="dash-header" onclick="toggleCard(this)">ğŸ’¬ ìµëª…ê²Œì‹œíŒ</div>
  <div class="dash-content">
    <input id="boardName" class="input-field" placeholder="ë‹‰ë„¤ì„">
    <input id="boardPw" class="input-field" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <input id="boardTitle" class="input-field" placeholder="ì œëª©">
    <textarea id="boardContent" class="input-field textarea-field" placeholder="ë‚´ìš©"></textarea>
    <button class="action-btn bg-submit" onclick="addBoard()">ê¸€ ë“±ë¡</button>
    <ul id="boardList" class="post-list"></ul>
  </div>
</div>

<!-- ì„ê¸ˆ ê³„ì‚°ê¸° -->
<div class="dash-card">
  <div class="dash-header" onclick="toggleCard(this)">ğŸ’° ì„ê¸ˆ ê³„ì‚°ê¸°</div>
  <div class="dash-content">
    <input id="hour" class="input-field" type="number" placeholder="ì‹œê¸‰">
    <input id="dayTime" class="input-field" type="number" placeholder="ì£¼ê°„ ì‹œê°„">
    <input id="nightTime" class="input-field" type="number" placeholder="ì•¼ê°„ ì‹œê°„">
    <button class="action-btn bg-submit" onclick="calcWage()">ê³„ì‚°</button>
    <div id="wageResult"></div>
  </div>
</div>

<!-- 3 / 2 / 1 í•­ì—… -->
<div class="dash-card port3">
  <div class="dash-header" onclick="toggleCard(this)">âš“ğŸ›³ï¸ 3í•­ì—…</div>
  <div class="dash-content">í•œì§„ì‹ í•­ë§Œ(HJNC), BNCT</div>
</div>

<div class="dash-card port2">
  <div class="dash-header" onclick="toggleCard(this)">ğŸš¢âš™ï¸ 2í•­ì—…</div>
  <div class="dash-content">PNC, PNIT, HPNT</div>
</div>

<div class="dash-card port1">
  <div class="dash-header" onclick="toggleCard(this)">ğŸ—ï¸ğŸ“¦ 1í•­ì—…</div>
  <div class="dash-content">BPTC, HBCT</div>
</div>
<script>
/* ================= Firebase ì´ˆê¸°í™” ================= */
const firebaseConfig = {
  apiKey: "AIzaSyBDXy5HcYW-IZQJ9ZDEivr_yi99AxhYme8",
  authDomain: "my-app-d8527.firebaseapp.com",
  projectId: "my-app-d8527",
  storageBucket: "my-app-d8527.firebasestorage.app"
};

if (!firebase.apps.length) {
  firebase.initializeApp(firebaseConfig);
}
const db = firebase.firestore();

/* ================= ê³µí†µ ================= */
function toggleCard(el){
  el.parentElement.classList.toggle("expanded");
}

/* ================= ê³µì§€ì‚¬í•­ ================= */
function addNotice(){
  const title = noticeTitle.value.trim();
  const content = noticeContent.value.trim();
  if(!title || !content){
    alert("ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
    return;
  }
  if(prompt("ê´€ë¦¬ì ì•”í˜¸") !== "0346") return;

  db.collection("notices").add({
    title,
    content,
    created: firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    noticeTitle.value="";
    noticeContent.value="";
  });
}

db.collection("notices").orderBy("created","desc")
.onSnapshot(snap=>{
  noticeList.innerHTML="";
  snap.forEach(doc=>{
    const d = doc.data();
    noticeList.innerHTML += `
      <li class="post-item">
        <div onclick="this.nextElementSibling.style.display =
        this.nextElementSibling.style.display==='block'?'none':'block'">
          ğŸ“¢ ${d.title}
        </div>
        <div class="post-body">
          ${d.content}<br>
          <button onclick="deleteNotice('${doc.id}', event)">ì‚­ì œ</button>
        </div>
      </li>`;
  });
});

function deleteNotice(id, e){
  e.stopPropagation();
  if(prompt("ê´€ë¦¬ì ì•”í˜¸") !== "0346") return;
  if(confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
    db.collection("notices").doc(id).delete();
  }
}

/* ================= ìµëª…ê²Œì‹œíŒ ================= */
function addBoard(){
  if(!boardName.value || !boardPw.value || !boardTitle.value) return;

  db.collection("boards").add({
    name: boardName.value,
    pw: boardPw.value,
    title: boardTitle.value,
    content: boardContent.value,
    created: firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    boardName.value="";
    boardPw.value="";
    boardTitle.value="";
    boardContent.value="";
  });
}

db.collection("boards").orderBy("created","desc")
.onSnapshot(snap=>{
  boardList.innerHTML="";
  snap.forEach(doc=>{
    const d = doc.data();
    boardList.innerHTML += `
      <li class="post-item">
        <div onclick="this.nextElementSibling.style.display =
        this.nextElementSibling.style.display==='block'?'none':'block'">
          ğŸ’¬ ${d.title}
        </div>
        <div class="post-body">
          ${d.content}
          <div style="margin-top:8px;">
            <input id="cmt-${doc.id}" class="input-field" placeholder="ëŒ“ê¸€">
            <button onclick="addComment('${doc.id}')">ë“±ë¡</button>
            <div id="cmt-list-${doc.id}"></div>
          </div>
        </div>
      </li>`;
    loadComments(doc.id);
  });
});

/* ================= ëŒ“ê¸€ ================= */
function addComment(postId){
  const input = document.getElementById(`cmt-${postId}`);
  if(!input.value) return;

  db.collection("boards").doc(postId)
    .collection("comments")
    .add({
      text: input.value,
      created: firebase.firestore.FieldValue.serverTimestamp()
    });
  input.value="";
}

function loadComments(postId){
  db.collection("boards").doc(postId)
    .collection("comments")
    .orderBy("created")
    .onSnapshot(snap=>{
      const el = document.getElementById(`cmt-list-${postId}`);
      if(!el) return;
      el.innerHTML="";
      snap.forEach(d=>{
        el.innerHTML += `<div>ğŸ’¬ ${d.data().text}</div>`;
      });
    });
}

/* ================= ì„ê¸ˆ ê³„ì‚°ê¸° ================= */
function calcWage(){
  const h = +hour.value || 0;
  const d = +dayTime.value || 0;
  const n = +nightTime.value || 0;
  wageResult.innerText =
    (h*d + h*1.5*n).toLocaleString() + "ì›";
}
</script>
<!-- ================= í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ================= -->
<nav style="
position:fixed;
bottom:0;
left:0;
right:0;
height:60px;
background:#ffffff;
border-top:1px solid #e5e7eb;
display:flex;
justify-content:space-around;
align-items:center;
font-size:0.8rem;
z-index:1000;
">
  <div onclick="window.scrollTo({top:0,behavior:'smooth'})">ğŸ <br>í™ˆ</div>
  <div onclick="document.getElementById('notice-card').scrollIntoView({behavior:'smooth'})">ğŸ“¢<br>ê³µì§€</div>
  <div onclick="document.getElementById('board-card').scrollIntoView({behavior:'smooth'})">ğŸ’¬<br>ê²Œì‹œíŒ</div>
</nav>

<!-- í•˜ë‹¨ ë„¤ë¹„ ì—¬ë°± -->
<div style="height:70px;"></div>

<!-- ================= í† ìŠ¤íŠ¸ ================= -->
<div id="toast" style="
position:fixed;
bottom:90px;
left:50%;
transform:translateX(-50%);
background:#111;
color:#fff;
padding:10px 18px;
border-radius:20px;
font-size:0.8rem;
display:none;
z-index:2000;
">
ì•Œë¦¼
</div>

<script>
/* ================= í† ìŠ¤íŠ¸ ================= */
function showToast(msg){
  const t = document.getElementById("toast");
  t.innerText = msg;
  t.style.display = "block";
  setTimeout(()=>t.style.display="none", 2500);
}
</script>

</body>
</html>
