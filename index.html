<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>BUSAN HAK PORT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="ë¶€ì‚°í•­ ì‘ì—…ì ì •ë³´ ê³µìœ  Â· ê³µì§€ Â· ê²Œì‹œíŒ Â· ìë£Œì‹¤" />

  <!-- ì• ë“œì„¼ìŠ¤ ìŠ¹ì¸ í•„ìˆ˜ ë©”íƒ€ -->
  <meta name="robots" content="index,follow" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2563eb" />

  <style>
    :root {
      --primary:#2563eb; --danger:#dc2626; --bg:#f4f6f8; --card:#fff; --sub:#6b7280;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans KR",sans-serif;background:var(--bg)}
    header{background:linear-gradient(180deg,#3b82f6,#2563eb);color:#fff;text-align:center;padding:18px;font-size:1.3rem;font-weight:700}
    .container{max-width:900px;margin:auto;padding:12px}
    .card{background:var(--card);border-radius:14px;padding:14px;margin-bottom:14px;box-shadow:0 4px 10px rgba(0,0,0,.04)}
    h2{margin:4px 0 10px;font-size:1.05rem}
    input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #d1d5db;margin-bottom:8px}
    button{background:var(--primary);color:#fff;border:none;border-radius:10px;padding:10px 14px}
    ul{list-style:none;padding:0;margin:0}
    li{padding:10px 0;border-bottom:1px solid #e5e7eb}
    .meta{font-size:.75rem;color:var(--sub)}
    .danger{background:var(--danger)}
  </style>
</head>
<body>
<header>BUSAN HAK PORT</header>
<div class="container">

  <!-- ê³µì§€ -->
  <div class="card">
    <h2>ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
    <ul id="noticeList"></ul>
  </div>

  <!-- ê¸€ ì‘ì„± -->
  <div class="card">
    <h2>âœ ê¸€ ì‘ì„±</h2>
    <input id="title" placeholder="ì œëª©" />
    <input id="name" placeholder="ì‘ì„±ì" />
    <input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" />
    <textarea id="content" rows="4" placeholder="ë‚´ìš©"></textarea>
    <button onclick="addPost()">ë“±ë¡</button>
  </div>

  <!-- ê²Œì‹œíŒ -->
  <div class="card">
    <h2>ğŸ’¬ ê²Œì‹œíŒ</h2>
    <ul id="postList"></ul>
  </div>

  <!-- ìë£Œì‹¤ -->
  <div class="card">
    <h2>ğŸ“‚ ìë£Œì‹¤</h2>
    <ul id="fileList"></ul>
  </div>

  <!-- ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ (ì• ë“œì„¼ìŠ¤ í•„ìˆ˜) -->
  <div class="card">
    <h2>ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h2>
    <p style="font-size:.85rem;color:#374151">
      ë³¸ ì‚¬ì´íŠ¸ëŠ” ê²Œì‹œíŒ ìš´ì˜ì„ ìœ„í•´ ìµœì†Œí•œì˜ ì •ë³´ë§Œì„ ìˆ˜ì§‘í•˜ë©°,
      ìˆ˜ì§‘ëœ ì •ë³´ëŠ” ëª©ì  ì™¸ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </p>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
  apiKey: "AIzaSyBWFZr9TE9yybZJCJjEXSsv1YCpGkVb0kA",
  authDomain: "busan-hak-port.firebaseapp.com",
  projectId: "busan-hak-port",
  storageBucket: "busan-hak-port.firebasestorage.app",
  messagingSenderId: "616469111502",
  appId: "1:616469111502:web:6f3c94b15e444e04c7669f",
  measurementId: "G-QQ728TDFJ2"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ê¸€ ë“±ë¡
  window.addPost = async () => {
    const t=title.value.trim(), n=name.value.trim(), p=password.value.trim(), c=content.value.trim();
    if(!t||!n||!p||!c){alert('ëª¨ë‘ ì…ë ¥');return}
    await addDoc(collection(db,'posts'),{title:t,name:n,password:p,content:c,createdAt:serverTimestamp()});
    title.value=name.value=password.value=content.value='';
  };

  // ê²Œì‹œíŒ ì¶œë ¥ + ì‚­ì œ
  onSnapshot(query(collection(db,'posts'),orderBy('createdAt','desc')),snap=>{
    postList.innerHTML='';
    snap.forEach(d=>{
      const x=d.data();
      const li=document.createElement('li');
      li.innerHTML=`<b>${x.title}</b><div>${x.content}</div><div class='meta'>${x.name}</div><button class='danger'>ì‚­ì œ</button>`;
      li.querySelector('button').onclick=()=>{if(prompt('ë¹„ë°€ë²ˆí˜¸')===x.password)deleteDoc(doc(db,'posts',d.id))};
      postList.appendChild(li);
    })
  });

  // ê³µì§€
  onSnapshot(query(collection(db,'notices'),orderBy('createdAt','desc')),snap=>{
    noticeList.innerHTML='';
    snap.forEach(d=>{const x=d.data();noticeList.innerHTML+=`<li>ğŸ“¢ ${x.title}</li>`})
  });

  // ìë£Œì‹¤ (í…ìŠ¤íŠ¸ ë§í¬ìš©)
  onSnapshot(query(collection(db,'files'),orderBy('createdAt','desc')),snap=>{
    fileList.innerHTML='';
    snap.forEach(d=>{const x=d.data();fileList.innerHTML+=`<li><a href='${x.url}' target='_blank'>${x.title}</a></li>`})
  });
</script>

<script>
  if('serviceWorker'in navigator){navigator.serviceWorker.register('service-worker.js')}
</script>
</body>
</html>
