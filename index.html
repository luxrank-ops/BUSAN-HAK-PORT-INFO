<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>í•­ë§Œ ì»¤ë®¤ë‹ˆí‹°</title>

<meta name="description" content="í•­ë§Œ ì¢…ì‚¬ìë¥¼ ìœ„í•œ ì •ë³´ ê³µìœ  ì»¤ë®¤ë‹ˆí‹°">
<meta name="robots" content="index,follow">

<style>
body{font-family:sans-serif;background:#f5f5f5;margin:0}
.container{max-width:900px;margin:auto;padding:15px}
.card{background:#fff;padding:15px;margin-bottom:15px;border-radius:8px}
.post-item{border-bottom:1px solid #ddd;padding:10px 0}
.post-header-row{display:flex;justify-content:space-between;cursor:pointer}
.post-body-content{display:none;padding-top:10px}
.page-num{margin:0 5px;cursor:pointer}
.page-num.active{font-weight:bold}
button{cursor:pointer}
</style>
</head>

<body>
<div class="container">

<h2>ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
<ul id="noticeList"></ul>

<h2>ğŸ“ ê²Œì‹œíŒ</h2>
<ul id="boardList"></ul>
<div id="pagination"></div>

<h2>ğŸš¢ ì„ ë°•ì •ë³´</h2>
<input id="shipSearch" placeholder="ì„ ë°• ê²€ìƒ‰" onkeyup="filterShips()">
<ul id="shipList"></ul>
<div id="shipPagination"></div>

<h2>ğŸ’¾ ìë£Œì‹¤</h2>
<input id="fileSearch" placeholder="íŒŒì¼ ê²€ìƒ‰" onkeyup="filterFiles()">
<ul id="fileList"></ul>
<div id="filePagination"></div>

<hr>
<p>
ë³¸ ì‚¬ì´íŠ¸ëŠ” í•­ë§Œ ì¢…ì‚¬ìë¥¼ ìœ„í•œ ì •ë³´ ê³µìœ  ì»¤ë®¤ë‹ˆí‹°ì…ë‹ˆë‹¤.<br>
ë¬¸ì˜: luxrank@gmail.com
</p>

</div>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
/* ğŸ”¥ Firebase ì„¤ì • (ë°˜ë“œì‹œ ë„ˆ ê±¸ë¡œ êµì²´) */
firebase.initializeApp({
  apiKey: "API_KEY",
  authDomain: "PROJECT.firebaseapp.com",
  projectId: "PROJECT"
});

const db = firebase.firestore();

/* ê³µí†µ ë³€ìˆ˜ */
let allPostsData=[], allShipsData=[], filteredShips=[], allFilesData=[];
let postsPerPage=5, currentBoardPage=1, currentShipPage=1, currentFilePage=1;

/* í† ê¸€ */
function toggleContent(id){
  const el=document.getElementById(id);
  el.style.display = el.style.display==="block" ? "none":"block";
}

/* ë°ì´í„° ë¡œë“œ */
function loadAllData(){

  db.collection("notices").orderBy("timestamp","desc")
  .onSnapshot(s=>{
    noticeList.innerHTML="";
    s.forEach(d=>{
      const n=d.data();
      noticeList.innerHTML+=`
        <li class="post-item">
          <div class="post-header-row" onclick="toggleContent('n-${d.id}')">
            <b>ğŸ“¢ ${n.title}</b><span>${n.date}</span>
          </div>
          <div id="n-${d.id}" class="post-body-content">${n.content}</div>
        </li>`;
    });
  });

  db.collection("posts").orderBy("timestamp","desc")
  .onSnapshot(s=>{
    allPostsData=[];
    s.forEach(d=>{
      let o=d.data(); o.id=d.id;
      allPostsData.push(o);
    });
    renderBoardPage(1);
  });

  db.collection("ships").orderBy("timestamp","desc")
  .onSnapshot(s=>{
    allShipsData=[];
    s.forEach(d=>{
      let o=d.data(); o.id=d.id;
      allShipsData.push(o);
    });
    filteredShips=[...allShipsData];
    renderShipPage(1);
  });

  db.collection("archives").orderBy("timestamp","desc")
  .onSnapshot(s=>{
    allFilesData=[];
    s.forEach(d=>{
      let o=d.data(); o.id=d.id;
      allFilesData.push(o);
    });
    renderFilePage(1);
  });
}

/* ê²Œì‹œíŒ */
function renderBoardPage(p){
  currentBoardPage=p;
  boardList.innerHTML="";
  allPostsData.slice((p-1)*postsPerPage,p*postsPerPage)
  .forEach(x=>{
    boardList.innerHTML+=`
      <li class="post-item">
        <div class="post-header-row" onclick="toggleContent('p-${x.id}')">
          <b>[${x.category}] ${x.title}</b>
          <span>${x.name} | ${x.date}</span>
        </div>
        <div id="p-${x.id}" class="post-body-content">${x.content}</div>
      </li>`;
  });
  renderPagination("pagination",Math.ceil(allPostsData.length/postsPerPage),p,renderBoardPage);
}

/* ì„ ë°• */
function renderShipPage(p){
  currentShipPage=p;
  shipList.innerHTML="";
  filteredShips.slice((p-1)*postsPerPage,p*postsPerPage)
  .forEach(x=>{
    shipList.innerHTML+=`
      <li class="post-item">
        <div onclick="toggleContent('s-${x.id}')">ğŸš¢ ${x.shipName}</div>
        <div id="s-${x.id}" class="post-body-content">
          <p>[ë³¸ì„ ] ${x.onboardFeat||'-'}</p>
          <p>[ìœ¡ìƒ] ${x.onshoreFeat||'-'}</p>
        </div>
      </li>`;
  });
  renderPagination("shipPagination",Math.ceil(filteredShips.length/postsPerPage),p,renderShipPage);
}

function filterShips(){
  const q=shipSearch.value.toUpperCase();
  filteredShips=allShipsData.filter(s=>s.shipName.toUpperCase().includes(q));
  renderShipPage(1);
}

/* ìë£Œì‹¤ */
function renderFilePage(p){
  currentFilePage=p;
  fileList.innerHTML="";
  allFilesData.slice((p-1)*postsPerPage,p*postsPerPage)
  .forEach(x=>{
    fileList.innerHTML+=`
      <li class="post-item">
        <a href="${x.fileUrl}" target="_blank">ğŸ’¾ ${x.title}</a>
      </li>`;
  });
  renderPagination("filePagination",Math.ceil(allFilesData.length/postsPerPage),p,renderFilePage);
}

function filterFiles(){
  const q=fileSearch.value.toUpperCase();
  [...fileList.children].forEach(li=>{
    li.style.display = li.innerText.toUpperCase().includes(q)?"":"none";
  });
}

/* í˜ì´ì§€ë„¤ì´ì…˜ */
function renderPagination(id,total,current,cb){
  const el=document.getElementById(id);
  el.innerHTML="";
  for(let i=1;i<=total;i++){
    const s=document.createElement("span");
    s.className="page-num"+(i===current?" active":"");
    s.innerText=i;
    s.onclick=()=>cb(i);
    el.appendChild(s);
  }
}

loadAllData();
</script>
</body>
</html>
