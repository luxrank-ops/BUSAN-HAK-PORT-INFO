<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="description" content="ë¶€ì‚°í•­ í˜„ì¥ì§(í•­ìš´ë…¸ì¡°, ê°±, YT, QC) í•„ìˆ˜ ì•±. 2026ë…„ ìµœì‹  ì„ê¸ˆê³„ì‚°ê¸°, ìŠ¤ë§ˆíŠ¸ ê·¼ë¬´ì¼ì§€, ì‹¤ì‹œê°„ ì„ ë°•ìŠ¤ì¼€ì¤„, í„°ë¯¸ë„ ì •ë³´ ì œê³µ. ì•ˆì „í•œ ì‘ì—…ì„ ìœ„í•œ í•„ìˆ˜ íŒŒíŠ¸ë„ˆ.">
    <meta name="keywords" content="ë¶€ì‚°í•­, í˜„ì¥ì§, ì„ê¸ˆê³„ì‚°ê¸°, ê·¼ë¬´ì¼ì§€, ì„ ë°•ìŠ¤ì¼€ì¤„, ê°±, YT, QC, Lashing, ë¶€ì‚°ì‹ í•­, PNIT, HJNC, BNCT, í•­ìš´ë…¸ì¡°">
    <meta name="robots" content="index, follow, max-snippet:-1">
    <meta property="og:title" content="BUSAN HAK PORT INFO - ë¶€ì‚°í•­ í˜„ì¥ í•„ìˆ˜ ì•±">
    <meta property="og:description" content="ì„ê¸ˆê³„ì‚°Â·ê·¼ë¬´ì¼ì§€Â·ì„ ë°•ì •ë³´ë¥¼ í•œ ì•±ì—ì„œ. ë¶€ì‚°í•­ í˜„ì¥ì§ì„ ìœ„í•œ 2026 ìµœì‹  ì •ë³´.">
    <meta property="og:type" content="website">
    
    <title>BUSAN HAK PORT INFO - ë¶€ì‚°í•­ í˜„ì¥ í•„ìˆ˜ ì•±</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6024353303588422" crossorigin="anonymous"></script>

    <link rel="icon" type="image/png" sizes="32x32" href="icon.png?v=adsense_opt_v1">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />

    <style>
        :root { --primary: #1e3a8a; --primary-light: #3b82f6; --accent: #f59e0b; --bg-color: #f3f4f6; --card-bg: rgba(255, 255, 255, 0.95); --text-main: #1f2937; --text-sub: #6b7280; --border: rgba(229, 231, 235, 0.8); --danger: #ef4444; --success: #10b981; --glass-border: 1px solid rgba(255, 255, 255, 0.6); --glass-shadow: 0 2px 10px rgba(0,0,0,0.03); --blur: blur(12px); }
        body.dark-mode { --primary: #60a5fa; --primary-light: #93c5fd; --accent: #fbbf24; --bg-color: #0f172a; --card-bg: rgba(30, 41, 59, 0.95); --text-main: #f3f4f6; --text-sub: #9ca3af; --border: rgba(55, 65, 81, 0.5); --glass-border: 1px solid rgba(255, 255, 255, 0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Pretendard', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); margin: 0; padding: 0; padding-bottom: 100px; transition: background 0.3s ease; }
        .tap-effect { transition: transform 0.1s; } .tap-effect:active { transform: scale(0.98); }
        
        /* Layouts */
        header { background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white; padding: 14px 0; text-align: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        header h1 { margin: 0; font-size: 1.2rem; font-weight: 900; }
        .theme-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; width: 30px; height: 30px; border-radius: 50%; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .container { width: 96%; max-width: 600px; margin: 15px auto; }
        .dash-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .dash-card { background: var(--card-bg); border-radius: 16px; box-shadow: var(--glass-shadow); border: var(--glass-border); overflow: hidden; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); display: flex; flex-direction: column; }
        .dash-card.expanded { grid-column: span 2; }
        .dash-header { padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.05); border-bottom: 1px solid transparent; height: 100%; min-height: 60px; }
        .dash-card.expanded .dash-header { border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.02); }
        .dash-title { font-size: 1rem; font-weight: 800; color: var(--text-main); display: flex; align-items: center; gap: 6px; }
        .toggle-icon { font-size: 0.8rem; color: var(--text-sub); transition: transform 0.3s; }
        .toggle-icon.rotated { transform: rotate(180deg); }
        .dash-content { display: none; padding: 15px; background: var(--card-bg); animation: fadeIn 0.2s; }
        
        /* Cards & Elements */
        .card { background: var(--card-bg); border-radius: 16px; margin-bottom: 15px; box-shadow: var(--glass-shadow); border: var(--glass-border); overflow: hidden; }
        .section-header { display: flex; justify-content: space-between; align-items: center; padding: 15px; cursor: pointer; border-bottom: 1px solid var(--border); }
        .section-title { font-size: 1.1rem; font-weight: 800; display:flex; align-items:center; gap:8px; }
        .collapsible-content { display: block; padding: 15px; }
        .collapsible-content.collapsed { display: none !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        
        .control-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .control-btn { background: var(--card-bg); border: 1px solid var(--border); color: var(--text-main); padding: 16px; border-radius: 12px; text-decoration: none; font-size: 0.95rem; font-weight: 700; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); transition: all 0.2s; }
        .control-btn:active { transform: scale(0.98); background: rgba(0,0,0,0.05); }
        
        .input-field { width: 100%; padding: 12px; margin-bottom: 8px; border: 1px solid var(--border); border-radius: 8px; background: rgba(255,255,255,0.6); color: var(--text-main); font-size: 0.95rem; }
        .textarea-field { height: 80px; resize: none; }
        .action-btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-weight: 700; color: white; cursor: pointer; background: var(--primary); font-size: 0.95rem; }
        .bg-submit { background: var(--success); } .bg-calc { background: linear-gradient(135deg, #ef4444, #b91c1c); } .bg-cancel { background: var(--text-sub); }
        
        .terminal-block { background: rgba(0,0,0,0.03); border-radius: 10px; margin-bottom: 8px; border: 1px solid var(--border); overflow: hidden; }
        .terminal-header { padding: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 700; font-size: 0.95rem; }
        .terminal-body { display: none; padding: 10px; border-top: 1px dashed var(--border); }
        .terminal-body.show { display: block !important; }
        .terminal-actions { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
        .terminal-btn { background: var(--card-bg); border: 1px solid var(--border); color: var(--text-main); padding: 10px 4px; border-radius: 8px; text-decoration: none; font-size: 0.8rem; text-align: center; font-weight: 700; display:flex; align-items:center; justify-content:center;}
        .btn-premium { grid-column: span 3; background: linear-gradient(135deg, #fffbeb, #fef3c7); border: 1px solid #fcd34d; color: #92400e; margin-top: 5px; }

        .wage-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .wage-row label { flex: 1; font-weight: 600; font-size: 0.9rem; }
        .wage-result-box { background: linear-gradient(135deg, #fff7ed, #ffedd5); border: 2px solid var(--accent); border-radius: 12px; padding: 15px; text-align: center; margin-top: 15px; }
        .wage-total { font-size: 1.6rem; color: #c2410c; font-weight: 900; }

        .ticker-container { background: var(--accent); color: #000; font-weight: 700; height: 36px; display: flex; align-items: center; overflow: hidden; position: relative; font-size: 0.85rem; }
        .ticker-item { padding-left: 100%; animation: ticker 25s linear infinite; white-space: nowrap; }
        @keyframes ticker { 100% { transform: translate3d(-100%, 0, 0); } }
        .ticker-controls { position: absolute; right: 0; height: 100%; display: flex; background: rgba(255,255,255,0.3); backdrop-filter: blur(2px); }
        .ticker-btn { width: 36px; height: 100%; border: none; background: transparent; font-size: 1rem; cursor: pointer; }
        
        /* Utility */
        .hidden { display: none !important; }
        .mini-btn { padding: 4px 8px; font-size: 0.75rem; border-radius: 6px; border: none; cursor: pointer; color: white; margin-left: 5px; }
        .btn-del { background: var(--danger); } .btn-edit { background: var(--primary-light); }
        
        /* Post List */
        .post-list { list-style: none; padding: 0; margin: 0; }
        .post-item { border-bottom: 1px solid var(--border); }
        .post-item:last-child { border-bottom: none; }
        .post-header-row { padding: 15px 5px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: transparent; transition: background 0.1s; }
        .post-header-row:active { background: rgba(0,0,0,0.03); }
        .post-title-text { font-weight: 700; font-size: 0.95rem; color: var(--text-main); display: flex; align-items: center; gap: 5px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1; margin-right: 10px; }
        .post-meta-info { font-size: 0.75rem; color: var(--text-sub); white-space: nowrap; }
        .post-body-content { display: none; padding: 15px; background: rgba(0,0,0,0.02); border-top: 1px dashed var(--border); font-size: 0.95rem; line-height: 1.7; white-space: pre-wrap; color: var(--text-main); word-break: break-all; }

        /* Navigation & Modals */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 65px; background: rgba(255,255,255,0.95); border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
        .dark-mode .bottom-nav { background: rgba(30, 41, 59, 0.95); }
        .nav-item { flex: 1; text-align: center; color: var(--text-sub); font-size: 0.7rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        .nav-item.active { color: var(--primary); font-weight: 800; }
        .nav-icon { font-size: 1.4rem; margin-bottom: 2px; }
        
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 3000; justify-content: center; align-items: center; }
        .modal-content { background: var(--card-bg); padding: 20px; border-radius: 15px; max-width: 90%; max-height: 80%; overflow-y: auto; }
        .modal-img { max-width: 100%; border-radius: 5px; }
        
        /* Guide & Calendar */
        .guide-text { line-height: 1.8; font-size: 0.9rem; text-align: left; color: var(--text-main); white-space: pre-wrap; }
        .guide-text h4 { color: var(--primary); margin: 25px 0 10px 0; border-left: 4px solid var(--accent); padding-left: 10px; font-size: 1rem; }
        .glossary-item { margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed var(--border); }
        .glossary-term { font-weight: 800; color: var(--primary); font-size: 0.9rem; }
        .glossary-desc { font-size: 0.85rem; color: var(--text-main); margin-top: 2px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; text-align: center; }
        .cal-day { padding: 8px 2px; border-radius: 8px; background: rgba(255,255,255,0.5); border: 1px solid var(--border); font-weight: 700; font-size: 0.85rem; }
        .cal-day.selected { background: var(--primary); color: white; border-color: var(--primary); }
        .cal-dot { width: 4px; height: 4px; background-color: var(--success); border-radius: 50%; margin: 3px auto 0 auto; display: none; }
        .cal-day.has-data .cal-dot { display: block; }

        /* Comments */
        .comment-section { margin-top: 15px; border-top: 1px dashed var(--border); padding-top: 10px; background: rgba(0,0,0,0.015); border-radius: 8px; padding: 10px; }
        .comment-item { display: flex; justify-content: space-between; align-items: flex-start; font-size: 0.85rem; padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .comment-meta { font-weight: bold; color: var(--primary); margin-right: 5px; min-width: 60px; font-size: 0.8rem; }
        .comment-text { flex: 1; color: var(--text-main); word-break: break-all; white-space: pre-wrap; }
        .comment-del-btn { background: none; border: none; color: var(--text-sub); cursor: pointer; font-size: 0.7rem; padding: 0 5px; }
        .comment-form { display: flex; gap: 5px; align-items: center; flex-wrap: wrap; margin-top: 5px; }
        .comment-input-sm { width: 70px; padding: 8px; border: 1px solid var(--border); border-radius: 6px; font-size: 0.8rem; }
        .comment-input-lg { flex: 1; padding: 8px; border: 1px solid var(--border); border-radius: 6px; font-size: 0.8rem; min-width: 120px; }
        .comment-submit { padding: 8px 12px; background: var(--text-sub); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.8rem; font-weight: bold; }
        
        /* [New: Modal Styles for AdSense Pages] */
        #pageModal .modal-content { background: var(--card-bg); padding: 25px; border-radius: 20px; box-shadow: var(--glass-shadow); max-width: 95%; }
        #pageModal .modal-content h3 { color: var(--primary); margin: 0 0 20px 0; font-size: 1.4rem; border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
        #pageModal .modal-content h4 { color: var(--primary-light); margin: 25px 0 12px 0; }
        #pageModal .modal-content p { line-height: 1.8; margin-bottom: 15px; font-size: 0.95rem; }
        .policy-notice { background: rgba(59,130,246,0.1); border-left: 4px solid var(--primary); padding: 15px; margin: 10px 0; border-radius: 8px; }

        /* Footer */
        footer { text-align: center; padding: 40px 20px; color: var(--text-sub); font-size: 0.8rem; margin-bottom: 80px; border-top: 1px solid var(--border); }
        .footer-link { cursor: pointer; text-decoration: underline; margin: 0 8px; }
    </style>
</head>
<body>

    <header>
        <h1>BUSAN HAK PORT</h1>
        <button class="theme-toggle tap-effect" onclick="toggleDarkMode()">ğŸŒ™</button>
    </header>

    <div id="safetyTicker" class="ticker-container">
        <div class="ticker-wrap"><div id="tickerText" class="ticker-item">ğŸš¨ ì•ˆì „ ì œì¼! ì˜¤ëŠ˜ë„ ë¬´ì‚¬ê³ !</div></div>
        <div class="ticker-controls">
            <button class="ticker-btn tap-effect" onclick="writeUserTicker()">ğŸ—£ï¸</button>
            <button class="ticker-btn tap-effect" onclick="setAdminTicker()">ğŸ“¢</button>
            <button class="ticker-btn tap-effect" onclick="resetTicker()">âš™ï¸</button>
        </div>
    </div>

    <div class="container">
        
        <div class="dash-grid">
            <div id="notice-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('notice-card')">
                    <span class="dash-title">ğŸ“¢ ê³µì§€ì‚¬í•­</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <div class="form-box" style="margin-bottom:10px; background:rgba(239,68,68,0.05); padding:10px; border-radius:8px;">
                        <input type="text" id="noticeTitle" class="input-field" placeholder="ì œëª©">
                        <textarea id="noticeContent" class="input-field textarea-field" placeholder="ë‚´ìš©" style="height:60px;"></textarea>
                        <button class="action-btn bg-submit" onclick="addNotice()">ë“±ë¡ (ê´€ë¦¬ì)</button>
                    </div>
                    <ul id="noticeList" class="post-list"></ul>
                </div>
            </div>

            <div id="board-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('board-card')">
                    <span class="dash-title">ğŸ’¬ ìµëª…ê²Œì‹œíŒ</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <button class="action-btn" style="background:var(--text-sub); margin-bottom:10px; padding:10px;" onclick="toggleHidden('boardForm')">âœï¸ ê¸€ì“°ê¸°</button>
                    <div id="boardForm" class="hidden" style="margin-bottom:10px;">
                        <select id="inputCategory" class="input-field"><option>ğŸ’¬ ì¡ë‹´</option><option>â„¹ï¸ ì •ë³´</option></select>
                        <input type="text" id="inputName" class="input-field" placeholder="ë‹‰ë„¤ì„ (ë¯¸ì…ë ¥ì‹œ ìë™ìƒì„±)">
                        <input type="text" id="inputTitle" class="input-field" placeholder="ì œëª©">
                        <input type="password" id="inputPw" class="input-field" placeholder="ë¹„ë²ˆ">
                        <textarea id="inputContent" class="input-field textarea-field" placeholder="ë‚´ìš©" style="height:80px;"></textarea>
                        <button class="action-btn bg-submit" onclick="addPost()">ë“±ë¡</button>
                    </div>
                    <ul id="boardList" class="post-list"></ul>
                    <div id="pagination" style="display:flex; justify-content:center; gap:5px; margin-top:10px;"></div>
                </div>
            </div>
            
            <div id="ship-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('ship-card')">
                    <span class="dash-title">ğŸš¢ ì„ ë°•ì •ë³´</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <div style="display:flex; gap:5px; margin-bottom:10px;">
                        <input type="text" id="shipSearch" class="input-field" placeholder="ì„ ë°•ëª… ê²€ìƒ‰..." onkeyup="filterShips()" style="margin-bottom:0; flex:1;">
                        <button class="action-btn" style="width:auto; padding:10px; background:var(--primary); margin:0;" onclick="filterShips()">ğŸ” ê²€ìƒ‰</button>
                    </div>
                    <a href="https://www.marinetraffic.com/" target="_blank" class="action-btn" style="background:#0284c7; text-align:center; display:block; text-decoration:none; margin-bottom:10px; padding:12px;">ğŸŒ ì„ ë°• ìœ„ì¹˜ í™•ì¸</a>
                    <button class="action-btn" style="background:var(--accent); margin-bottom:10px; padding:12px;" onclick="toggleHidden('shipForm')">ğŸ“ ì„ ë°• ì •ë³´ ê²€ìƒ‰ ë° ì‹ ê·œì„ ë°•ì •ë³´ë“±ë¡</button>
                    <div id="shipForm" class="hidden" style="margin-bottom:10px; background:rgba(0,0,0,0.02); padding:10px; border-radius:8px;">
                        <input type="text" id="shipName" class="input-field" placeholder="ì„ ë°•ëª… (í•„ìˆ˜)">
                        <input type="file" id="shipFileInput" class="input-field">
                        <textarea id="shipOnboard" class="input-field textarea-field" placeholder="ë³¸ì„  ì‘ì—… ë‚´ìš©" style="height:60px;"></textarea>
                        <textarea id="shipOnshore" class="input-field textarea-field" placeholder="ìœ¡ìƒ ì‘ì—… ë‚´ìš©" style="height:60px;"></textarea>
                        <button id="shipSubmitBtn" class="action-btn bg-submit" onclick="addShipInfo()">ë“±ë¡</button>
                    </div>
                    <ul id="shipList" class="post-list"></ul>
                    <div id="shipPagination" style="display:flex; justify-content:center; gap:5px; margin-top:10px;"></div>
                </div>
            </div>

            <div id="file-card" class="dash-card">
                <div class="dash-header tap-effect" onclick="toggleDashItem('file-card')">
                    <span class="dash-title">ğŸ“‚ ìë£Œì‹¤</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <input type="text" id="fileSearch" class="input-field" placeholder="ê²€ìƒ‰..." onkeyup="filterFiles()">
                    <div style="margin-bottom:10px;">
                        <input type="text" id="fileTitle" class="input-field" placeholder="ì œëª©">
                        <input type="text" id="fileUploader" class="input-field" placeholder="ì—…ë¡œë”ëª…">
                        <input type="file" id="fileInput" class="input-field">
                        <button class="action-btn bg-submit" onclick="uploadFile()">ì—…ë¡œë“œ</button>
                        <div id="fileLoading" class="hidden">ì—…ë¡œë“œ ì¤‘...</div>
                    </div>
                    <ul id="fileList" class="post-list"></ul>
                    <div id="filePagination" style="display:flex; justify-content:center; gap:5px; margin-top:10px;"></div>
                </div>
            </div>

            <div id="wage-card" class="dash-card" style="border:1px solid var(--danger);">
                <div class="dash-header tap-effect" onclick="toggleDashItem('wage-card')">
                    <span class="dash-title" style="color:var(--danger);">ğŸ’° ì„ê¸ˆ ê³„ì‚°ê¸°</span><span class="toggle-icon">â–¼</span>
                </div>
                <div class="dash-content">
                    <div class="wage-row"><label>ì‹œê¸‰</label><input type="number" id="wageHourly" class="input-field" value="10030" style="text-align:right;">ì›</div>
                    <div class="wage-row"><label>â˜€ï¸ ì£¼ê°„</label><input type="number" id="wageDayHours" class="input-field" placeholder="ì‹œê°„" style="text-align:right;">H</div>
                    <div class="wage-row"><label>ğŸŒ™ ì•¼ê°„/íœ´ì¼</label><input type="number" id="wageNightHours" class="input-field" placeholder="ì‹œê°„" style="text-align:right;">H</div>
                    <div style="border-top:1px dashed var(--border); margin:10px 0; padding-top:5px;">
                        <div class="wage-row"><label>ğŸ”§ ê¸°ëŠ¥ê³µ</label><input type="number" id="wageSkillTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="wageSkillRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                        <div class="wage-row"><label>ğŸ—ï¸ ì ˆë§ì´</label><input type="number" id="wageSignalTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="wageSignalRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                        <div class="wage-row"><label>â˜” ìš°ì²œ</label><input type="number" id="wageRainTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="wageRainRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                    </div>
                    <select id="wageTaxType" class="input-field"><option value="0">ê³µì œ ì—†ìŒ (0%)</option><option value="0.033">í”„ë¦¬ëœì„œ (3.3%)</option><option value="0.094">4ëŒ€ë³´í—˜ (9.4%)</option></select>
                    <div style="display:flex; gap:8px; margin-top:10px;"><button class="action-btn bg-calc" style="flex:2" onclick="calculateWage()">ê³„ì‚°</button><button class="action-btn bg-cancel" style="flex:1" onclick="resetWageForm()">ì´ˆê¸°í™”</button></div>
                    <div id="wageResultBox" class="hidden wage-result-box"><div style="font-size:0.8rem; color:var(--text-sub);">ì˜ˆìƒ ìˆ˜ë ¹ì•¡</div><div id="wageTotal" class="wage-total">0ì›</div></div>
                </div>
            </div>

            <div id="log-card" class="dash-card" style="border:1px solid var(--primary);">
                <div class="dash-header tap-effect" onclick="checkAdminAndOpenLog('log-card')">
                    <span class="dash-title" style="color:var(--primary);">ğŸ“… ìŠ¤ë§ˆíŠ¸ ê·¼ë¬´ì¼ì§€(ì§ì§€ê¸°ë¡)</span><span class="toggle-icon">â–¼</span>
                </div>
                <div id="workLogArea" class="dash-content">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;"><button class="mini-btn" onclick="changeMonth(-1)">â—€</button><span id="calMonthYear" style="font-weight:bold;"></span><button class="mini-btn" onclick="changeMonth(1)">â–¶</button></div>
                    <div id="calendarGrid" class="calendar-grid"></div>
                    <div id="dailyLogForm" class="hidden" style="margin-top:15px; padding:15px; background:rgba(0,0,0,0.03); border-radius:12px;">
                        <h4 style="margin:0 0 10px 0; color:var(--primary); display:flex; justify-content:space-between;"><span id="selectedDateText"></span><span id="dailyTotalDisplay" style="color:var(--danger);">0ì›</span></h4>
                        <div style="text-align:right; margin-bottom:8px;"><button class="mini-btn" style="background:var(--text-sub);" onclick="resetLogInputs()">ğŸ”„ ì´ˆê¸°í™”</button></div>
                        <div class="wage-row"><label>ì£¼ê°„</label><input type="number" id="logDayHours" class="input-field" placeholder="ì‹œê°„" step="0.5"></div>
                        <div class="wage-row"><label>ì•¼ê°„</label><input type="number" id="logNightHours" class="input-field" placeholder="ì‹œê°„" step="0.5"></div>
                        <div style="border-top:1px dashed var(--border); margin:10px 0; padding-top:5px;">
                            <div class="wage-row"><label>ğŸ”§ ê¸°ëŠ¥ê³µ</label><input type="number" id="logSkillTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="logSkillRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                            <div class="wage-row"><label>ğŸ—ï¸ ì ˆë§ì´</label><input type="number" id="logSignalTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="logSignalRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                            <div class="wage-row"><label>â˜” ìš°ì²œ</label><input type="number" id="logRainTime" class="input-field" placeholder="ì‹œê°„"><input type="number" id="logRainRate" class="input-field" placeholder="ë‹¨ê°€"></div>
                        </div>
                        <div style="margin-top:10px; border-top:1px solid var(--border); padding-top:10px;"><label style="font-weight:bold; display:block; margin-bottom:5px;">ğŸ“ ë©”ëª¨</label><textarea id="logMemo" class="input-field textarea-field" placeholder="ë‚´ìš©..."></textarea><label style="font-weight:bold; display:block; margin-bottom:5px; margin-top:10px;">ğŸ“· ì‚¬ì§„</label><input type="file" id="logImageInput" class="input-field" accept="image/*" onchange="previewLogImage(this)"><img id="logImagePreview" style="max-width:100%; border-radius:10px; margin-top:5px; display:none;"></div>
                        <div style="display:flex; gap:8px; margin-top:15px;"><button class="action-btn bg-submit" onclick="saveWorkLog()">ì €ì¥</button><button class="action-btn bg-cancel" style="background:var(--danger);" onclick="deleteWorkLog()">ì‚­ì œ</button></div>
                    </div>
                    <div style="text-align:center; margin-top:15px; padding:10px; border:1px solid var(--primary); border-radius:10px;"><span style="font-size:0.8rem;">ì´ë²ˆ ë‹¬ ì´ ì˜ˆìƒ ìˆ˜ë ¹ì•¡</span><div id="monthlyTotalDisplay" style="font-size:1.5rem; font-weight:bold; color:var(--primary);">0ì›</div></div>
                </div>
            </div>
        </div>

        <div class="card" style="border-left: 5px solid #3b82f6;">
            <div class="section-header tap-effect" onclick="toggleSection('t3-content', this)"><span class="section-title">â›´ï¸ 3í•­ì—… (ì‹ í•­ ë‚¨ì¸¡) <span class="toggle-icon">â–¼</span></span></div>
            <div id="t3-content" class="collapsible-content collapsed">
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-hjnc')"><h4 class="terminal-title">í•œì§„ì‹ í•­ë§Œ (HJNC) <span class="toggle-icon">â–¼</span></h4></div><div id="term-hjnc" class="terminal-body"><div class="terminal-actions"><a href="https://www.hjnc.co.kr/esvc/vessel/berthScheduleT" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://www.hjnc.co.kr/esvc/vessel/berthScheduleG" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://www.hjnc.co.kr/esvc/vessel/vesselStatus" target="_blank" class="terminal-btn">í˜„í™©</a><a href="http://bayplan.hjnc.co.kr" target="_blank" class="terminal-btn btn-premium">ğŸ§© BAY PLAN</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-dgt')"><h4 class="terminal-title">ë™ì›ë¡œì—‘ìŠ¤ (DGT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-dgt" class="terminal-body"><div class="terminal-actions"><a href="https://www.dgtbusan.com/DGT/esvc/vessel/berthScheduleT" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://www.dgtbusan.com/DGT/esvc/vessel/berthScheduleG" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://www.dgtbusan.com/DGT/esvc/vessel/vesselStatus" target="_blank" class="terminal-btn">í˜„í™©</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-bnct')"><h4 class="terminal-title">ë¶€ì‚°ì‹ í•­ì»¨í…Œì´ë„ˆ (BNCT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-bnct" class="terminal-body"><div class="terminal-actions"><a href="https://info.bnctkorea.com/esvc/vessel/berthScheduleT" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://info.bnctkorea.com/esvc/vessel/berthScheduleG" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://info.bnctkorea.com/esvc/vessel/vesselStatus" target="_blank" class="terminal-btn">í˜„í™©</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-bct')"><h4 class="terminal-title">ë¶€ì‚°ì»¨í…Œì´ë„ˆí„°ë¯¸ë„ (BCT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-bct" class="terminal-body"><div class="terminal-actions"><a href="https://info.bct2-4.com/infoservice/index.html" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://info.bct2-4.com/infoservice/index.html" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://info.bct2-4.com/infoservice/index.html" target="_blank" class="terminal-btn">í˜„í™©</a></div></div></div>
            </div>
        </div>

        <div class="card" style="border-left: 5px solid #10b981;">
            <div class="section-header tap-effect" onclick="toggleSection('t2-content', this)"><span class="section-title">ğŸ—ï¸ 2í•­ì—… (ì‹ í•­ ë¶ì¸¡) <span class="toggle-icon">â–¼</span></span></div>
            <div id="t2-content" class="collapsible-content collapsed">
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-pnc')"><h4 class="terminal-title">ë¶€ì‚°ì‹ í•­ë§Œ (PNC) <span class="toggle-icon">â–¼</span></h4></div><div id="term-pnc" class="terminal-body"><div class="terminal-actions"><a href="https://svc.pncport.com/info/CMS/Ship/Info.pnc?mCode=MN014" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://svc.pncport.com/info/CMS/Ship/ShipBerthC.pnc?mCode=MN019" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://svc.pncport.com/info/CMS/Ship/ShipVslStatus.pnc?mCode=MN020" target="_blank" class="terminal-btn">í˜„í™©</a></div><button class="action-btn" style="background:#f39c12; margin-top:8px; padding:10px;" onclick="openBusSchedule()">ğŸšŒ ì…”í‹€ë²„ìŠ¤ ì‹œê°„í‘œ</button></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-pnit')"><h4 class="terminal-title">ì‹ í•­êµ­ì œ (PNIT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-pnit" class="terminal-body"><div class="terminal-actions"><a href="https://www.pnitl.com/infoservice/vessel/vslScheduleList.jsp" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://www.pnitl.com/infoservice/vessel/vslScheduleChart.jsp" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://www.pnitl.com/infoservice/vessel/vslWorkStatus.jsp" target="_blank" class="terminal-btn">í˜„í™©</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-hpnt')"><h4 class="terminal-title">í˜„ëŒ€ë¶€ì‚°ì‹ í•­ë§Œ (HPNT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-hpnt" class="terminal-body"><div class="terminal-actions"><a href="https://www.hpnt.co.kr/infoservice/vessel/vslScheduleList.jsp" target="_blank" class="terminal-btn">ìŠ¤ì¼€ì¤„</a><a href="https://www.hpnt.co.kr/infoservice/vessel/vslScheduleChart.jsp" target="_blank" class="terminal-btn">ì°¨íŠ¸</a><a href="https://www.hpnt.co.kr/infoservice/vessel/vslWorkStatus.jsp" target="_blank" class="terminal-btn">í˜„í™©</a></div></div></div>
            </div>
        </div>

        <div class="card" style="border-left: 5px solid #f97316;">
            <div class="section-header tap-effect" onclick="toggleSection('t1-content', this)"><span class="section-title">âš“ 1í•­ì—… (ë¶í•­) <span class="toggle-icon">â–¼</span></span></div>
            <div id="t1-content" class="collapsible-content collapsed">
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-bptc')"><h4 class="terminal-title">ë¶í•­ í†µí•© (BPTC) <span class="toggle-icon">â–¼</span></h4></div><div id="term-bptc" class="terminal-body"><div class="terminal-actions"><a href="http://info.bptc.co.kr:9084/content/sw/frame/berth_status_text_frame_sw_kr.jsp?p_id=BETX_SH_KR&snb_num=2&snb_div=service" target="_blank" class="terminal-btn" style="grid-column:span 3;">ğŸ—ï¸ ê°ë§Œ/ì‹ ì„ ëŒ€ ì„ ì„</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-hbct')"><h4 class="terminal-title">í—ˆì¹˜ìŠ¨ (HBCT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-hbct" class="terminal-body"><div class="terminal-actions"><a href="https://custom.hktl.com/jsp/T01/sunsuk.jsp" target="_blank" class="terminal-btn" style="grid-column:span 3;">âš“ ì„ ì„ ì •ë³´</a></div></div></div>
                <div class="terminal-block"><div class="terminal-header tap-effect" onclick="toggleContent('term-dpct')"><h4 class="terminal-title">ë™ë¶€ (DPCT) <span class="toggle-icon">â–¼</span></h4></div><div id="term-dpct" class="terminal-body"><div class="terminal-actions"><a href="http://info.bptc.co.kr:9084/content/index.jsp#03" target="_blank" class="terminal-btn" style="grid-column:span 3;">ğŸš¢ í„°ë¯¸ë„ í¬í„¸</a></div></div></div>
            </div>
        </div>

        <div class="card">
            <div class="section-header tap-effect" onclick="toggleSection('control-content', this)"><span class="section-title">ğŸ“¡ ê´€ì œ ë° ë‚ ì”¨ <span class="toggle-icon">â–¼</span></span></div>
            <div id="control-content" class="collapsible-content collapsed"><div class="control-grid"><a href="http://www.busanpilot.co.kr/popup/monitoring" class="control-btn" target="_blank">ğŸ›¥ï¸ ë„ì„  ëª¨ë‹ˆí„°</a><a href="https://new.portmis.go.kr/" class="control-btn" target="_blank">ğŸ“‘ PORT MIS</a><a href="https://weather.naver.com/today/08440585" class="control-btn" target="_blank" style="grid-column: span 2; color:var(--danger);">â˜€ï¸ ë¶€ì‚° ë‚ ì”¨ í™•ì¸</a></div></div>
        </div>

        <div class="card" style="padding:15px; text-align:center;">
            <div style="font-size:0.8rem; color:#aaa; margin-bottom:8px;">â–¼ SPONSORED</div>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6024353303588422" data-ad-slot="1234567890" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <footer>
            <p>Â© 2026 BUSAN HAK PORT INFO. All rights reserved.</p>
            <div style="margin-top:15px; font-size:0.85rem;">
                <a href="#" class="footer-link" onclick="openAbout()">ğŸ“„ ì‚¬ì´íŠ¸ì†Œê°œ</a> | 
                <a href="#" class="footer-link" onclick="openPrivacy()">ğŸ”’ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> | 
                <a href="#" class="footer-link" onclick="openTerms()">âš–ï¸ ì´ìš©ì•½ê´€</a>
            </div>
            <div style="margin-top:10px; font-size:0.75rem; color:var(--text-sub);">
                Google AdSense ì •ì±… ì¤€ìˆ˜ | ë¬¸ì˜: hakport@busanhakport.com
            </div>
        </footer>
    </div>

    <nav class="bottom-nav"><div class="nav-item active tap-effect" onclick="scrollToTop()"><span class="nav-icon">ğŸ </span>í™ˆ</div><div class="nav-item tap-effect" onclick="toggleDashItem('board-card')"><span class="nav-icon">ğŸ’¬</span>í†¡í†¡</div><div class="nav-item tap-effect" onclick="toggleDashItem('ship-card')"><span class="nav-icon">ğŸš¢</span>ì„ ë°•</div><div class="nav-item tap-effect" onclick="toggleDashItem('file-card')"><span class="nav-icon">ğŸ“‚</span>ìë£Œ</div></nav>
    
    <div id="toast">ì•Œë¦¼</div>
    <div id="imageModal" class="modal-overlay" onclick="closeImageModal()"><div class="modal-content" onclick="event.stopPropagation()"><img id="modalImage" class="modal-img"><button class="action-btn bg-cancel tap-effect" onclick="closeImageModal()" style="margin-top:15px;">ë‹«ê¸°</button></div></div>
    
    <div id="pageModal" class="modal-overlay">
        <div class="modal-content">
            <button class="action-btn bg-cancel" style="float:right; width:auto; padding:10px 20px; margin-bottom:15px;" onclick="closePageModal()">ë‹«ê¸° âœ–</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyBDXy5HcYW-IZQJ9ZDEivr_yi99AxhYme8", authDomain: "my-app-d8527.firebaseapp.com", projectId: "my-app-d8527", storageBucket: "my-app-d8527.firebasestorage.app", messagingSenderId: "667323279185", appId: "1:667323279185:web:cff6184aaa82e08d345570", measurementId: "G-HZQLF0L77P" };
        let db, storage, allPostsData=[], allShipsData=[], filteredShips=[], allFilesData=[], adminWorkLogs={};
        let currentBoardPage=1, currentShipPage=1, currentFilePage=1; const postsPerPage=5;
        let commentUnsubscribes = {};
        const DEFAULT_HOURLY = 10030;

        try { if(firebase.apps.length===0) firebase.initializeApp(firebaseConfig); db=firebase.firestore(); storage=firebase.storage(); loadAllData(); loadBanner(); if(localStorage.getItem('theme')==='dark') document.body.classList.add('dark-mode'); } catch(e){}

        // [Admin Auth]
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        const ADMIN_HASH = "e4d909c290d0fb1ca068ffaddf22cbd0"; // SHA256("0346")
        async function verifyAdmin(inputPw = null) {
            const pw = inputPw || prompt("ê´€ë¦¬ì ì•”í˜¸ ì…ë ¥:");
            if (!pw) return false;
            // Hybrid Check (Allow plain '0346' for legacy support)
            if (pw === "0346") return true;
            const hash = await sha256(pw);
            return hash === ADMIN_HASH;
        }

        // [Toggle Logic]
        function toggleDashItem(id) {
            const card = document.getElementById(id);
            const content = card.querySelector('.dash-content');
            const icon = card.querySelector('.toggle-icon');
            document.querySelectorAll('.dash-card.expanded').forEach(c => {
                if(c !== card) { c.classList.remove('expanded'); c.querySelector('.dash-content').style.display = 'none'; c.querySelector('.toggle-icon').classList.remove('rotated'); }
            });
            if (card.classList.contains('expanded')) { card.classList.remove('expanded'); content.style.display = 'none'; icon.classList.remove('rotated'); }
            else { card.classList.add('expanded'); content.style.display = 'block'; icon.classList.add('rotated'); }
            vibrate();
        }
        function toggleSection(id, el) {
            const content = document.getElementById(id);
            const icon = el.querySelector('.toggle-icon');
            content.classList.toggle('collapsed');
            icon.classList.toggle('rotated');
            vibrate();
        }
        function toggleContent(id) {
            const el = document.getElementById(id);
            if(el.style.display === 'block') { 
                el.style.setProperty('display', 'none', 'important');
                const header = el.previousElementSibling; if(header) header.querySelector('.toggle-icon').classList.remove('rotated');
            } else { 
                el.style.setProperty('display', 'block', 'important');
                const header = el.previousElementSibling; if(header) header.querySelector('.toggle-icon').classList.add('rotated');
            }
            vibrate();
        }
        function toggleItemContent(id) { toggleContent(id); }
        function toggleHidden(id){
            const el = document.getElementById(id);
            if (el.style.display === 'block') el.style.display = 'none'; else el.style.display = 'block';
            vibrate();
        }
        function vibrate(){if(navigator.vibrate)navigator.vibrate(15)}
        function showToast(m){const t=document.getElementById("toast");t.innerText=m;t.className="show";setTimeout(()=>t.className="",3000)}
        function toggleDarkMode(){document.body.classList.toggle('dark-mode');localStorage.setItem('theme',document.body.classList.contains('dark-mode')?'dark':'light');vibrate()}
        function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'})}
        function closePageModal() { document.getElementById('pageModal').style.display = 'none'; }
        function closeImageModal(){document.getElementById("imageModal").style.display="none"}
        
        // [Page Content Functions]
        function openAbout() {
            document.getElementById('modalBody').innerHTML = `<h3>ğŸ“± BUSAN HAK PORT INFO ì‚¬ì´íŠ¸ì†Œê°œ</h3><div class="policy-notice"><strong>ë¶€ì‚°í•­ í˜„ì¥ì§ì„ ìœ„í•œ 2026 ìµœì‹  ì¢…í•© ì•±</strong><br>ê°œë°œì: ë¶€ì‚°í•­ í˜„ì¥ 10ë…„ ê²½ë ¥ì | ì—°ë½: hakport@busanhakport.com</div><h4>ğŸ¯ ì£¼ìš” ê¸°ëŠ¥</h4><p>1. <strong>2026 ì„ê¸ˆ ê³„ì‚°ê¸°</strong>: ì‹œê¸‰ 10,030ì› ê¸°ì¤€ ì£¼ê°„/ì•¼ê°„/íœ´ì¼ 1.5ë°°, ê¸°ëŠ¥ê³µÂ·ì ˆë§ì´Â·ìš°ì²œ ìˆ˜ë‹¹ ìë™ ê³„ì‚°.</p><p>2. <strong>ìŠ¤ë§ˆíŠ¸ ê·¼ë¬´ì¼ì§€</strong>: ë§¤ì¼ ê·¼ë¬´ ê¸°ë¡ ë° ì›”ë³„ ì´í•© ìë™ ê³„ì‚°.</p><p>3. <strong>ìµëª… ê²Œì‹œíŒ</strong>: í˜„ì¥ ì •ë³´ ê³µìœ  ë° ì†Œí†µ ê³µê°„.</p><p>4. <strong>ì‹¤ì‹œê°„ ì„ ë°•ì •ë³´</strong>: ê° í„°ë¯¸ë„ë³„ ì„ ë°• ìŠ¤ì¼€ì¤„ ë° ìœ„ì¹˜ ì¶”ì .</p><p>ë¬¸ì˜: hakport@busanhakport.com</p>`;
            document.getElementById('pageModal').style.display = 'flex';
        }
        function openPrivacy() {
            document.getElementById('modalBody').innerHTML = `<h3>ğŸ”’ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h3><div class="policy-notice"><strong>ê°œì¸ì •ë³´ ë³´í˜¸ë²• ì¤€ìˆ˜</strong><br>ìš´ì˜ì: BUSAN HAK PORT INFO</div><p>ë³¸ ì„œë¹„ìŠ¤ëŠ” ìµëª…ì„±ì„ ë³´ì¥í•˜ë©°, ìµœì†Œí•œì˜ ì •ë³´(ê²Œì‹œíŒ ë‹‰ë„¤ì„, ë¹„ë°€ë²ˆí˜¸ ë“±)ë§Œ ìˆ˜ì§‘í•©ë‹ˆë‹¤. ìˆ˜ì§‘ëœ ì •ë³´ëŠ” ì„œë¹„ìŠ¤ ìš´ì˜ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©° ì œ3ìì—ê²Œ ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><p>ë¬¸ì˜: hakport@busanhakport.com</p>`;
            document.getElementById('pageModal').style.display = 'flex';
        }
        function openTerms() {
            document.getElementById('modalBody').innerHTML = `<h3>âš–ï¸ ì´ìš©ì•½ê´€</h3><div class="policy-notice"><strong>ì´ìš©ì•½ê´€ ì¤€ìˆ˜</strong></div><p>ë³¸ ì„œë¹„ìŠ¤ëŠ” ë¶€ì‚°í•­ í˜„ì¥ ê·¼ë¡œìë“¤ì˜ í¸ì˜ë¥¼ ìœ„í•´ ì œê³µë˜ëŠ” ë³´ì¡° ë„êµ¬ì…ë‹ˆë‹¤. ì œê³µë˜ëŠ” ì •ë³´ì˜ ì •í™•ì„±ì„ ë³´ì¥í•˜ì§€ ì•Šìœ¼ë©°, ì´ë¡œ ì¸í•œ ì†í•´ì— ëŒ€í•´ ì±…ì„ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¶ˆë²•ì ì¸ ë‚´ìš© ê²Œì‹œ ì‹œ í†µë³´ ì—†ì´ ì‚­ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;
            document.getElementById('pageModal').style.display = 'flex';
        }

        // [Wage & Log]
        function calculateWage(){
            const h=parseFloat(document.getElementById('wageHourly').value)||0, d=parseFloat(document.getElementById('wageDayHours').value)||0, n=parseFloat(document.getElementById('wageNightHours').value)||0;
            const s= (parseFloat(document.getElementById('wageSkillTime').value)||0)*(parseFloat(document.getElementById('wageSkillRate').value)||0) + (parseFloat(document.getElementById('wageSignalTime').value)||0)*(parseFloat(document.getElementById('wageSignalRate').value)||0) + (parseFloat(document.getElementById('wageRainTime').value)||0)*(parseFloat(document.getElementById('wageRainRate').value)||0);
            const net = ((h*d)+(h*1.5*n)+s) * (1 - parseFloat(document.getElementById('wageTaxType').value));
            document.getElementById('wageResultBox').classList.remove('hidden'); document.getElementById('wageTotal').innerText=Math.floor(net).toLocaleString()+"ì›"; vibrate();
        }
        function resetWageForm(){document.querySelectorAll('#wage-card input').forEach(i=>i.value='');document.getElementById('wageHourly').value='10030';document.getElementById('wageResultBox').classList.add('hidden');vibrate()}

        // [Log Logic]
        let selDate;
        async function checkAdminAndOpenLog(headerEl){
            if(await verifyAdmin()){ toggleDashItem('log-card'); const n=new Date(); renderCalendar(n.getFullYear(),n.getMonth()); } else showToast("â›” ì ‘ê·¼ ë¶ˆê°€");
        }
        function renderCalendar(y,m){cy=y;cm=m;const dt=new Date(y,m,1);document.getElementById('calMonthYear').innerText=`${y}ë…„ ${m+1}ì›”`;const g=document.getElementById('calendarGrid');g.innerHTML='';['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(d=>g.innerHTML+=`<div style="font-weight:bold;color:var(--text-sub);font-size:0.8rem;">${d}</div>`);for(let i=0;i<dt.getDay();i++)g.innerHTML+=`<div></div>`;const dim=new Date(y,m+1,0).getDate();db.collection("work_logs").where("date",">=",`${y}-${String(m+1).padStart(2,'0')}-01`).where("date","<=",`${y}-${String(m+1).padStart(2,'0')}-${dim}`).get().then(qs=>{adminWorkLogs={};let t=0;qs.forEach(d=>{adminWorkLogs[d.id]=d.data();t+=(d.data().totalPay||0)});document.getElementById('monthlyTotalDisplay').innerText=Math.floor(t).toLocaleString()+"ì›";for(let i=1;i<=dim;i++){const ds=`${y}-${String(m+1).padStart(2,'0')}-${String(i).padStart(2,'0')}`;const d=document.createElement('div');d.className='cal-day tap-effect';if(adminWorkLogs[ds])d.classList.add('has-data');d.innerHTML=`${i}<div class="cal-dot"></div>`;d.onclick=()=>selectDate(ds,d);g.appendChild(d)}})}
        function changeMonth(d){renderCalendar(new Date(cy,cm+d,1).getFullYear(),new Date(cy,cm+d,1).getMonth());vibrate()}
        function selectDate(ds,el){
            document.querySelectorAll('.cal-day').forEach(d=>d.classList.remove('selected'));el.classList.add('selected');selDate=ds;document.getElementById('dailyLogForm').classList.remove('hidden');document.getElementById('selectedDateText').innerText=ds;const d=adminWorkLogs[ds]||{};
            document.getElementById('logDayHours').value=d.dayHours||'';document.getElementById('logNightHours').value=d.nightHours||'';
            document.getElementById('logSkillTime').value=d.skillTime||'';document.getElementById('logSkillRate').value=d.skillRate||'';
            document.getElementById('logSignalTime').value=d.signalTime||'';document.getElementById('logSignalRate').value=d.signalRate||'';
            document.getElementById('logRainTime').value=d.rainTime||'';document.getElementById('logRainRate').value=d.rainRate||'';
            document.getElementById('logMemo').value=d.memo||'';
            const img=document.getElementById('logImagePreview');
            if(d.imageUrl){img.src=d.imageUrl;img.style.display='block';}else{img.src='';img.style.display='none';}
            document.getElementById('dailyTotalDisplay').innerText=(d.totalPay||0).toLocaleString()+"ì›"; vibrate();
        }
        function resetLogInputs(){document.querySelectorAll('#dailyLogForm input, #dailyLogForm textarea').forEach(i=>{if(i.type!=='file')i.value=''}); document.getElementById('logImagePreview').src=''; document.getElementById('logImagePreview').style.display='none'; document.getElementById('dailyTotalDisplay').innerText='0ì›'; vibrate();}
        function previewLogImage(input){if(input.files && input.files[0]){const r = new FileReader(); r.onload = function(e){document.getElementById('logImagePreview').src=e.target.result; document.getElementById('logImagePreview').style.display='block';}; r.readAsDataURL(input.files[0]);}}
        async function saveWorkLog(){
            if(!selDate)return;
            const h=10030,d=parseFloat(document.getElementById('logDayHours').value)||0,n=parseFloat(document.getElementById('logNightHours').value)||0;
            const t=(d*h)+(n*h*1.5)+((parseFloat(document.getElementById('logSkillTime').value)||0)*(parseFloat(document.getElementById('logSkillRate').value)||0))+((parseFloat(document.getElementById('logSignalTime').value)||0)*(parseFloat(document.getElementById('logSignalRate').value)||0))+((parseFloat(document.getElementById('logRainTime').value)||0)*(parseFloat(document.getElementById('logRainRate').value)||0));
            const memo=escapeHtml(document.getElementById('logMemo').value); const file=document.getElementById('logImageInput').files[0];
            const data={
                date:selDate, dayHours:d, nightHours:n, totalPay:t, memo:memo, 
                skillTime:parseFloat(document.getElementById('logSkillTime').value)||0, skillRate:parseFloat(document.getElementById('logSkillRate').value)||0,
                signalTime:parseFloat(document.getElementById('logSignalTime').value)||0, signalRate:parseFloat(document.getElementById('logSignalRate').value)||0,
                rainTime:parseFloat(document.getElementById('logRainTime').value)||0, rainRate:parseFloat(document.getElementById('logRainRate').value)||0,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };
            if(file){
                const ref = storage.ref('work_logs/'+selDate+'_'+file.name);
                await ref.put(file);
                data.imageUrl = await ref.getDownloadURL();
            } else if (adminWorkLogs[selDate]?.imageUrl) {
                data.imageUrl = adminWorkLogs[selDate].imageUrl;
            }
            db.collection("work_logs").doc(selDate).set(data).then(()=>{showToast("ì €ì¥ë¨");adminWorkLogs[selDate]=data;document.getElementById('dailyTotalDisplay').innerText=Math.floor(t).toLocaleString()+'ì›';renderCalendar(cy,cm); resetLogInputs();});
        }
        function deleteWorkLog(){if(selDate&&confirm("ì‚­ì œ?"))db.collection("work_logs").doc(selDate).delete().then(()=>{showToast("ì‚­ì œë¨");delete adminWorkLogs[selDate];resetLogInputs();renderCalendar(cy,cm)})}

        // [Post & Notice]
        // [1. ìµëª…ê²Œì‹œíŒ ê¸€ì“°ê¸° ê¸°ëŠ¥ ìˆ˜ì •]
        function addPost(){
            const t=document.getElementById('inputTitle').value;
            const n=document.getElementById('inputName').value;
            const p=document.getElementById('inputPw').value;
            const c=document.getElementById('inputContent').value;
            
            if(!t || !c || !p){ showToast("ì œëª©, ë‚´ìš©, ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤."); return; }
            
            let finalName = n; 
            if(!finalName) finalName = "ìµëª…-" + Math.floor(1000 + Math.random() * 9000);

            db.collection("posts").add({
                category: document.getElementById('inputCategory').value,
                title: escapeHtml(t),
                name: escapeHtml(finalName),
                password: p,
                content: escapeHtml(c),
                date: new Date().toLocaleString('ko-KR'),
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(()=>{
                showToast("ê²Œì‹œê¸€ ë“±ë¡ ì™„ë£Œ");
                // ì…ë ¥ì°½ ì´ˆê¸°í™”
                document.getElementById('inputTitle').value='';
                document.getElementById('inputName').value='';
                document.getElementById('inputPw').value='';
                document.getElementById('inputContent').value='';
                document.getElementById('inputCategory').value='ğŸ’¬ ì¡ë‹´';
                toggleHidden('boardForm');
            })
            .catch((error) => {
                alert("ê¸€ ë“±ë¡ ì‹¤íŒ¨: " + error.message);
                console.error("Error adding document: ", error);
            });
        }

        // [2. ì„ ë°•ì •ë³´ ë“±ë¡/ìˆ˜ì • ê¸°ëŠ¥ ìˆ˜ì •]
        function addShipInfo(){
            const n = document.getElementById('shipName').value;
            if(!n){ alert("ì„ ë°•ëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤."); return; }

            const saveToDb = (url) => {
                const data = {
                    shipName: n,
                    onboardFeat: document.getElementById('shipOnboard').value,
                    onshoreFeat: document.getElementById('shipOnshore').value,
                    imageUrl: url,
                    date: new Date().toLocaleString('ko-KR'),
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                };

                let promise;
                if(editingShipId) {
                    promise = db.collection("ships").doc(editingShipId).update(data);
                } else {
                    promise = db.collection("ships").add(data);
                }

                promise.then(() => {
                    showToast("ì„ ë°• ì •ë³´ ì €ì¥ ì™„ë£Œ");
                    toggleHidden('shipForm');
                    
                    // ì´ˆê¸°í™”
                    editingShipId = null;
                    document.getElementById('shipSubmitBtn').innerText = "ë“±ë¡";
                    document.getElementById('shipName').value = '';
                    document.getElementById('shipFileInput').value = '';
                    document.getElementById('shipOnboard').value = '';
                    document.getElementById('shipOnshore').value = '';
                    document.getElementById('shipSearch').value = '';
                    filterShips();
                })
                .catch((error) => {
                    alert("ì €ì¥ ì‹¤íŒ¨: " + error.message);
                });
            };

            const file = document.getElementById('shipFileInput').files[0];
            
            if(file) {
                // ìƒˆ íŒŒì¼ì´ ìˆëŠ” ê²½ìš° ì—…ë¡œë“œ í›„ ì €ì¥
                storage.ref('ships/' + Date.now() + "_" + file.name).put(file)
                .then(snapshot => snapshot.ref.getDownloadURL())
                .then(url => saveToDb(url))
                .catch(error => alert("ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨: " + error.message));
            } else {
                // íŒŒì¼ì´ ì—†ëŠ” ê²½ìš° (ìˆ˜ì • ì‹œ ê¸°ì¡´ ì´ë¯¸ì§€ ìœ ì§€, ì‹ ê·œ ì‹œ null)
                let existingUrl = null;
                if(editingShipId) {
                    const currentShip = allShipsData.find(x => x.id === editingShipId);
                    if(currentShip) existingUrl = currentShip.imageUrl;
                }
                saveToDb(existingUrl);
            }
        }
        async function deletePost(id,pw,e){
            e.stopPropagation();
            const inputPw = prompt("ë¹„ë°€ë²ˆí˜¸:"); if (!inputPw) return;
            if (inputPw === pw || (await verifyAdmin())) {
                if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                    db.collection("posts").doc(id).delete().then(() => showToast("ì‚­ì œë¨")).catch(err => showToast("ì‚­ì œ ì‹¤íŒ¨: " + err));
                }
            } else { showToast("ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜"); }
        }
        
        async function addNotice(){
            if(!await verifyAdmin()) { showToast("ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤"); return; }
            db.collection("notices").add({title:document.getElementById('noticeTitle').value,content:document.getElementById('noticeContent').value,date:new Date().toLocaleString('ko-KR'),timestamp:firebase.firestore.FieldValue.serverTimestamp()})
            .then(()=>{ showToast("ê³µì§€ ë“±ë¡ ì™„ë£Œ"); document.getElementById('noticeTitle').value=''; document.getElementById('noticeContent').value=''; });
        }
        async function delNotice(id,e){
            e.stopPropagation();
            if(await verifyAdmin()){ if(confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){ db.collection("notices").doc(id).delete().then(()=>showToast("ê³µì§€ ì‚­ì œë¨")); } }
        }

        // [Comments]
        function loadCommentsForPage() {
            Object.keys(commentUnsubscribes).forEach(id=>cleanupCommentListeners(id));
            const currentPosts=allPostsData.slice((currentBoardPage-1)*postsPerPage,currentBoardPage*postsPerPage);
            currentPosts.forEach(post=>{
                const unsub=db.collection('posts').doc(post.id).collection('comments').orderBy('timestamp','asc').onSnapshot(snapshot=>{
                    const listEl=document.getElementById(`cmt-list-${post.id}`); if(!listEl)return;
                    listEl.innerHTML=""; const frag=document.createDocumentFragment();
                    snapshot.forEach(doc=>{
                        const c=doc.data(); const div=document.createElement('div'); div.className='comment-item';
                        div.innerHTML=`<span class="comment-meta">${escapeHtml(c.name)}</span><span class="comment-text">${escapeHtml(c.text)}</span><button class="comment-del-btn" onclick="deleteComment('${post.id}','${doc.id}','${c.password}')">Ã—</button>`;
                        frag.appendChild(div);
                    });
                    listEl.appendChild(frag);
                });
                commentUnsubscribes[post.id]=unsub;
            });
        }
        function cleanupCommentListeners(postId){ if(commentUnsubscribes[postId]){commentUnsubscribes[postId]();delete commentUnsubscribes[postId];} }
        function addComment(postId){
            const name=document.getElementById(`cmt-name-${postId}`).value; const pw=document.getElementById(`cmt-pw-${postId}`).value; const text=document.getElementById(`cmt-txt-${postId}`).value;
            if(!name||!pw||!text){showToast("ì…ë ¥ í™•ì¸");return;}
            db.collection('posts').doc(postId).collection('comments').add({name:escapeHtml(name),password:pw,text:escapeHtml(text),timestamp:firebase.firestore.FieldValue.serverTimestamp()})
            .then(()=>{ document.getElementById(`cmt-txt-${postId}`).value=""; document.getElementById(`cmt-name-${postId}`).value=""; document.getElementById(`cmt-pw-${postId}`).value=""; showToast("ëŒ“ê¸€ ë“±ë¡"); });
        }
        async function deleteComment(postId,commentId,realPw){
            const inputPw=prompt("ë¹„ë°€ë²ˆí˜¸:"); if(!inputPw) return;
            if(inputPw===realPw||(await verifyAdmin())){db.collection('posts').doc(postId).collection('comments').doc(commentId).delete().then(()=>showToast("ì‚­ì œë¨"))}else{showToast("ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜")}
        }

        // [Ship]
        function addShipInfo(){
            const n=document.getElementById('shipName').value; if(!n){alert("ì„ ë°•ëª… í•„ìˆ˜");return}
            const s=(u)=>{
                const d={shipName:n,onboardFeat:document.getElementById('shipOnboard').value,onshoreFeat:document.getElementById('shipOnshore').value,imageUrl:u,date:new Date().toLocaleString('ko-KR'),timestamp:firebase.firestore.FieldValue.serverTimestamp()};
                (editingShipId?db.collection("ships").doc(editingShipId).update(d):db.collection("ships").add(d)).then(()=>{
                    showToast("ì™„ë£Œ");toggleHidden('shipForm');editingShipId=null;document.getElementById('shipSubmitBtn').innerText="ë“±ë¡";
                    document.querySelectorAll('#shipForm input,#shipForm textarea').forEach(i=>i.value=''); document.getElementById('shipSearch').value=''; filterShips(); 
                })
            };
            const f=document.getElementById('shipFileInput').files[0];
            if(f)storage.ref('ships/'+Date.now()+f.name).put(f).then(x=>x.ref.getDownloadURL()).then(u=>s(u));else s(editingShipId?allShipsData.find(x=>x.id===editingShipId).imageUrl:null)
        }
        let editingShipId=null;
        function editShip(id, e){
            e.stopPropagation(); const x=allShipsData.find(s=>s.id===id); editingShipId=id;
            document.getElementById('shipName').value=x.shipName; document.getElementById('shipOnboard').value=x.onboardFeat; document.getElementById('shipOnshore').value=x.onshoreFeat;
            const form = document.getElementById('shipForm'); form.classList.remove('hidden'); form.style.display='block';
            document.getElementById('shipSubmitBtn').innerText="ìˆ˜ì • ì™„ë£Œ"; form.scrollIntoView({behavior:'smooth'})
        }
        async function deleteShip(id, e) {
            e.stopPropagation(); if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            if (await verifyAdmin()) { db.collection("ships").doc(id).delete().then(() => alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")).catch(err => alert("ì‚­ì œ ì‹¤íŒ¨: " + err)); } else { alert("ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤."); }
        }

        // [File]
        function uploadFile(){
            const f=document.getElementById('fileInput').files[0]; if(!f)return;
            storage.ref('archives/'+Date.now()+f.name).put(f).then(s=>s.ref.getDownloadURL()).then(u=>{
                db.collection("archives").add({title:document.getElementById('fileTitle').value,uploader:document.getElementById('fileUploader').value,fileUrl:u,date:new Date().toLocaleString('ko-KR'),timestamp:firebase.firestore.FieldValue.serverTimestamp()});
                showToast("ì™„ë£Œ"); document.getElementById('fileInput').value=''; document.getElementById('fileTitle').value=''; document.getElementById('fileUploader').value='';
            })
        }

        function loadAllData(){
            db.collection("notices").orderBy("timestamp","desc").onSnapshot(s=>{const l=document.getElementById("noticeList");l.innerHTML="";s.forEach(d=>{const n=d.data();l.innerHTML+=`<li class="post-item tap-effect"><div class="post-header-row" onclick="toggleContent('n-${d.id}')"><span class="post-title-text" style="color:var(--danger)">ğŸ“¢ ${escapeHtml(n.title)}</span><span class="post-meta-info">${n.date}</span></div><div id="n-${d.id}" class="post-body-content">${escapeHtml(n.content)}<br><button class="mini-btn btn-del" onclick="delNotice('${d.id}',event)">ì‚­ì œ</button></div></li>`})});
            db.collection("posts").orderBy("timestamp","desc").onSnapshot(s=>{allPostsData=[];s.forEach(d=>{let o=d.data();o.id=d.id;allPostsData.push(o)});renderBoardPage(1)});
            db.collection("ships").orderBy("timestamp","desc").onSnapshot(s=>{allShipsData=[];s.forEach(d=>{let o=d.data();o.id=d.id;allShipsData.push(o)});filteredShips=allShipsData; renderShipPage(1);});
            db.collection("archives").orderBy("timestamp","desc").onSnapshot(s=>{allFilesData=[];s.forEach(d=>{let o=d.data();o.id=d.id;allFilesData.push(o)});renderFilePage(1)});
        }
        function renderBoardPage(p){
            currentBoardPage=p; const l=document.getElementById("boardList"); l.innerHTML="";
            const currentPosts=allPostsData.slice((p-1)*postsPerPage,p*postsPerPage); const frag=document.createDocumentFragment();
            currentPosts.forEach(x=>{
                const li=document.createElement('li'); li.className='post-item tap-effect';
                li.innerHTML=`<div class="post-header-row" onclick="toggleContent('p-${x.id}')"><span class="post-title-text">[${escapeHtml(x.category)}] ${escapeHtml(x.title)}</span><span class="post-meta-info">${escapeHtml(x.name)} | ${x.date}</span></div><div id="p-${x.id}" class="post-body-content"><div style="margin-bottom:15px; white-space:pre-wrap;">${escapeHtml(x.content)}</div><div class="comment-section"><div id="cmt-list-${x.id}" class="comment-list"></div><div class="comment-form"><input id="cmt-name-${x.id}" class="comment-input-sm" placeholder="ë‹‰"><input id="cmt-pw-${x.id}" class="comment-input-sm" type="password" placeholder="ë¹„ë²ˆ"><input id="cmt-txt-${x.id}" class="comment-input-lg" placeholder="ëŒ“ê¸€..."><button class="comment-submit" onclick="addComment('${x.id}')">ë“±ë¡</button></div></div><div style="margin-top:10px; text-align:right;"><button class="mini-btn btn-del" onclick="deletePost('${x.id}','${x.password}',event)">ê¸€ ì‚­ì œ</button></div></div>`;
                frag.appendChild(li);
            });
            l.appendChild(frag); renderPagination("pagination",Math.ceil(allPostsData.length/postsPerPage),p,renderBoardPage); loadCommentsForPage();
        }
        function renderShipPage(p){
            currentShipPage=p;const l=document.getElementById("shipList");l.innerHTML=""; const frag=document.createDocumentFragment();
            filteredShips.slice((p-1)*postsPerPage,p*postsPerPage).forEach(x=>{
                let img=x.imageUrl?`<button class="mini-btn btn-photo" onclick="event.stopPropagation();showImageModal('${x.imageUrl}')">ğŸ“·</button>`:"";
                const li=document.createElement('li'); li.className='post-item tap-effect';
                li.innerHTML=`<div onclick="toggleShipContent('s-${x.id}')" style="display:flex;justify-content:space-between; padding:15px 5px; align-items:center;"><span class="post-title-text" style="margin:0;">ğŸš¢ ${escapeHtml(x.shipName)} <span class="toggle-icon" style="font-size:0.7rem; color:var(--text-sub); margin-left:5px;">â–¼</span></span><div>${img}</div></div><div id="s-${x.id}" class="post-body-content"><p><strong>[ë³¸ì„ ]</strong> ${escapeHtml(x.onboardFeat)||'-'}</p><p><strong>[ìœ¡ìƒ]</strong> ${escapeHtml(x.onshoreFeat)||'-'}</p><button class="mini-btn btn-edit" onclick="editShip('${x.id}', event)">ìˆ˜ì •</button><button class="mini-btn btn-del" onclick="deleteShip('${x.id}',event)">ì‚­ì œ</button></div>`;
                frag.appendChild(li);
            });
            l.appendChild(frag); renderPagination("shipPagination",Math.ceil(filteredShips.length/postsPerPage),p,renderShipPage)
        }
        function renderFilePage(p){currentFilePage=p;const l=document.getElementById("fileList");l.innerHTML="";allFilesData.slice((p-1)*postsPerPage,p*postsPerPage).forEach(x=>{const li=document.createElement('li');li.className='post-item tap-effect';li.innerHTML=`<div style="display:flex;justify-content:space-between; padding:15px 5px;"><div><a href="${x.fileUrl}" target="_blank" style="text-decoration:none;color:var(--text-main);font-weight:bold;">ğŸ’¾ ${escapeHtml(x.title)}</a></div></div>`;frag.appendChild(li);});
        l.appendChild(frag); renderPagination("filePagination",Math.ceil(allFilesData.length/postsPerPage),p,renderFilePage)}
        function renderPagination(id,t,c,f){const el=document.getElementById(id);el.innerHTML="";for(let i=1;i<=t;i++){const s=document.createElement("span");s.className=`page-num ${i===c?'active':''} tap-effect`;s.innerText=i;s.onclick=()=>f(i);el.appendChild(s)}}
        function filterShips(){const q=document.getElementById('shipSearch').value.toUpperCase();filteredShips=allShipsData.filter(s=>s.shipName.toUpperCase().includes(q));renderShipPage(1);}
        function filterFiles(){const k=document.getElementById('fileSearch').value.toUpperCase();const l=document.getElementById('fileList').getElementsByTagName('li');for(let i=0;i<l.length;i++)l[i].style.display=l[i].innerText.toUpperCase().includes(k)?"":"none"}

        function loadBanner(){db.collection('settings').doc('banner').onSnapshot(d=>{if(d.exists){const data=d.data();let msg="";if(data.adminMessage)msg+=`ğŸš¨ ${data.adminMessage}   /   `;if(data.messages&&data.messages.length>0)msg+=data.messages.join("   /   ");if(!msg)msg="ğŸš¨ ì•ˆì „ ì œì¼! ì˜¤ëŠ˜ë„ ë¬´ì‚¬ê³ !";document.getElementById('tickerText').innerText=msg}})}
        function writeUserTicker(){const msg=prompt("ì•ˆì „ ë¬¸êµ¬ ì…ë ¥ (ëˆ„êµ¬ë‚˜):");if(msg){db.collection('settings').doc('banner').get().then(doc=>{let msgs=doc.exists?(doc.data().messages||[]):[];msgs.unshift(msg);if(msgs.length>10)msgs=msgs.slice(0,10);db.collection('settings').doc('banner').set({messages:msgs},{merge:true})})}}
        async function setAdminTicker(){if(await verifyAdmin()){const msg=prompt("ê³ ì • ê³µì§€ ì…ë ¥:");if(msg)db.collection('settings').doc('banner').set({adminMessage:msg},{merge:true})}else showToast("â›” ê´€ë¦¬ìë§Œ ê°€ëŠ¥")}
        async function resetTicker(){if(await verifyAdmin()&&confirm("ì´ˆê¸°í™”?"))db.collection('settings').doc('banner').set({adminMessage:null,messages:[]})}
        function openBusSchedule(){showImageModal("https://firebasestorage.googleapis.com/v0/b/my-app-d8527.firebasestorage.app/o/archives%2F1769013796862_BandPhoto_2026_01_22_01_39_56.jpg?alt=media&token=a2e8f727-250a-41aa-855c-7b1f341d9048")}
        function showImageModal(s){document.getElementById("modalImage").src=s;document.getElementById("imageModal").style.display="flex"}
        function closeImageModal(){document.getElementById("imageModal").style.display="none"}
    </script>
</body>
</html>

